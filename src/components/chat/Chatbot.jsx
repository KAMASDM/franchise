import React, { useState, useRef, useEffect } from "react";
import {
  Fab,
  Dialog,
  DialogTitle,
  DialogContent,
  Box,
  Button,
  Typography,
  Avatar,
  Paper,
  IconButton,
  Divider,
  CircularProgress,
  Chip,
  Card,
  CardContent,
  CardActions,
  List,
  ListItem,
  ListItemText,
  ListItemIcon,
  Badge,
  Grid,
  Stack,
} from "@mui/material";
import { 
  Chat as ChatIcon, 
  Close, 
  Support,
  Business,
  AttachMoney,
  LocationOn,
  TrendingUp,
  CheckCircle,
  Star,
  Launch
} from "@mui/icons-material";
import { useNavigate } from "react-router-dom";
import UserInfoForm from "./UserInfoForm";
import { db } from "../../firebase/firebase";
import { collection, query, where, getDocs, addDoc, serverTimestamp } from "firebase/firestore";
import NotificationService from "../../utils/NotificationService";
import { BrandMatchingService } from "../../utils/BrandMatchingService";
import { INVESTMENT_RANGES, INDUSTRIES } from "../../constants";
import { generateBrandSlug } from "../../utils/brandUtils";
import logger from "../../utils/logger";

const Chatbot = () => {
  const navigate = useNavigate();
  const [open, setOpen] = useState(false);
  const [chatPhase, setChatPhase] = useState("pre-chat");
  const [userInfo, setUserInfo] = useState(null);
  const [messages, setMessages] = useState([]);
  const [isLoading, setIsLoading] = useState(false);
  const [currentQuestionStep, setCurrentQuestionStep] = useState(1);
  const [userResponses, setUserResponses] = useState({});
  const [brandsData, setBrandsData] = useState([]);
  const [matchedBrands, setMatchedBrands] = useState([]);
  const chatEndRef = useRef(null);

  const scrollToBottom = () => {
    chatEndRef.current?.scrollIntoView({ behavior: "smooth" });
  };

  useEffect(() => {
    scrollToBottom();
  }, [messages]);

  // Fetch approved brands when component mounts
  useEffect(() => {
    const fetchApprovedBrands = async () => {
      try {
        const brandsCollection = collection(db, "brands");
        const q = query(brandsCollection, where("status", "==", "active"));
        const querySnapshot = await getDocs(q);
        const brands = querySnapshot.docs.map((doc) => ({
          id: doc.id,
          ...doc.data(),
        }));
        setBrandsData(brands);
      } catch (error) {
        logger.error("Error fetching brands:", error);
      }
    };
    
    fetchApprovedBrands();
  }, []);

  // Smart brand matching using the dedicated service
  const findMatchingBrands = async (responses, userInfo) => {
    if (brandsData.length === 0) return [];

    // Transform responses to match BrandMatchingService format
    const userPreferences = {
      budget: userInfo.budget,
      location: userInfo.location,
      interests: [responses.industry],
      experience: responses.experience,
      timeline: responses.timeline,
      riskTolerance: responses.riskTolerance
    };

    try {
      const matches = await BrandMatchingService.matchBrands(userPreferences, brandsData);
      
      // Transform matches to include user-friendly reasons
      return matches.slice(0, 5).map(match => ({
        ...match.brand,
        matchScore: Math.round(match.matchScore),
        matchReasons: generateUserFriendlyReasons(match.matchFactors, responses, userInfo)
      }));
    } catch (error) {
      logger.error("Error in brand matching:", error);
      // Fallback to simple matching
      return brandsData
        .filter(brand => 
          brand.industries?.some(industry => 
            industry.toLowerCase().includes(responses.industry?.toLowerCase()) ||
            responses.industry?.toLowerCase().includes(industry.toLowerCase())
          )
        )
        .slice(0, 3)
        .map(brand => ({
          ...brand,
          matchScore: 75,
          matchReasons: [`Matches your interest in ${responses.industry}`, `Available in your location`]
        }));
    }
  };

  const generateUserFriendlyReasons = (matchFactors, responses, userInfo) => {
    const reasons = [];
    
    if (matchFactors.budgetScore > 70) {
      reasons.push(`Perfect fit for your budget of ‚Çπ${userInfo.budget}`);
    } else if (matchFactors.budgetScore > 50) {
      reasons.push(`Within your budget range`);
    }

    if (matchFactors.industryScore > 80) {
      reasons.push(`Excellent match for ${responses.industry} industry`);
    } else if (matchFactors.industryScore > 50) {
      reasons.push(`Related to your interest in ${responses.industry}`);
    }

    if (responses.experience === "No Business Experience") {
      reasons.push(`Comprehensive training and support for beginners`);
    } else if (responses.experience.includes("Experience")) {
      reasons.push(`Great opportunity for experienced investors`);
    }

    if (responses.riskTolerance === "Low Risk") {
      reasons.push(`Low-risk investment model`);
    } else if (responses.riskTolerance === "High Risk") {
      reasons.push(`High growth potential`);
    } else {
      reasons.push(`Balanced risk-return profile`);
    }

    return reasons.slice(0, 3); // Limit to top 3 reasons
  };

  const getGreeting = (name, budget, language = "English") => {
    const greetings = {
      English: `Hello ${name}! üëã I'm here to help you find the perfect franchise opportunity based on your preferences and budget of ‚Çπ${budget}.`,
      Hindi: `‡§®‡§Æ‡§∏‡•ç‡§§‡•á ${name}! üëã ‡§Æ‡•à‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§™‡§∏‡§Ç‡§¶ ‡§î‡§∞ ‚Çπ${budget} ‡§ï‡•á ‡§¨‡§ú‡§ü ‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞ ‡§∏‡§π‡•Ä ‡§´‡•ç‡§∞‡•à‡§Ç‡§ö‡§æ‡§á‡§ú‡§º‡•Ä ‡§Ö‡§µ‡§∏‡§∞ ‡§ñ‡•ã‡§ú‡§®‡•á ‡§Æ‡•á‡§Ç ‡§Ü‡§™‡§ï‡•Ä ‡§Æ‡§¶‡§¶ ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ø‡§π‡§æ‡§Å ‡§π‡•Ç‡§Å‡•§`,
      Gujarati: `‡™®‡™Æ‡™∏‡´ç‡™§‡´á ${name}! üëã ‡™π‡´Å‡™Ç ‡™§‡™Æ‡™æ‡™∞‡´Ä ‡™™‡™∏‡™Ç‡™¶‡™ó‡´Ä ‡™Ö‡™®‡´á ‚Çπ${budget} ‡™®‡™æ ‡™¨‡™ú‡´á‡™ü‡™®‡™æ ‡™Ü‡™ß‡™æ‡™∞‡´á ‡™∏‡™Ç‡™™‡´Ç‡™∞‡´ç‡™£ ‡™´‡´ç‡™∞‡´á‡™®‡´ç‡™ö‡™æ‡™á‡™ù ‡™§‡™ï ‡™∂‡´ã‡™ß‡™µ‡™æ‡™Æ‡™æ‡™Ç ‡™§‡™Æ‡™®‡´á ‡™Æ‡™¶‡™¶ ‡™ï‡™∞‡™µ‡™æ ‡™Ö‡™π‡´Ä‡™Ç ‡™õ‡´Å‡™Ç‡•§`,
      Marathi: `‡§®‡§Æ‡§∏‡•ç‡§ï‡§æ‡§∞ ${name}! üëã ‡§Æ‡•Ä ‡§§‡•Å‡§Æ‡§ö‡•ç‡§Ø‡§æ ‡§™‡§∏‡§Ç‡§§‡•Ä‡§®‡•Å‡§∏‡§æ‡§∞ ‡§Ü‡§£‡§ø ‚Çπ${budget} ‡§ö‡•ç‡§Ø‡§æ ‡§¨‡§ú‡•á‡§ü‡§µ‡§∞ ‡§Ü‡§ß‡§æ‡§∞‡§ø‡§§ ‡§Ø‡•ã‡§ó‡•ç‡§Ø ‡§´‡•ç‡§∞‡§Å‡§ö‡§æ‡§Ø‡§ù‡•Ä ‡§∏‡§Ç‡§ß‡•Ä ‡§∂‡•ã‡§ß‡§£‡•ç‡§Ø‡§æ‡§§ ‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§≤‡§æ ‡§Æ‡§¶‡§§ ‡§ï‡§∞‡§£‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä ‡§Ø‡•á‡§•‡•á ‡§Ü‡§π‡•á‡•§`,
      Tamil: `‡Æµ‡Æ£‡Æï‡Øç‡Æï‡ÆÆ‡Øç ${name}! üëã ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æµ‡Æø‡Æ∞‡ØÅ‡Æ™‡Øç‡Æ™‡Æ§‡Øç‡Æ§‡Æø‡Æ±‡Øç‡Æï‡ØÅ‡ÆÆ‡Øç ‚Çπ${budget} ‡Æ™‡Æü‡Øç‡Æú‡ØÜ‡Æü‡Øç‡Æü‡Æø‡Æ±‡Øç‡Æï‡ØÅ‡ÆÆ‡Øç ‡Æè‡Æ±‡Øç‡Æ± ‡Æö‡Æ∞‡Æø‡ÆØ‡Ææ‡Æ© ‡Æâ‡Æ∞‡Æø‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ≥‡Æ∞‡Øç ‡Æµ‡Ææ‡ÆØ‡Øç‡Æ™‡Øç‡Æ™‡Øà‡Æï‡Øç ‡Æï‡Æ£‡Øç‡Æü‡ØÅ‡Æ™‡Æø‡Æü‡Æø‡Æï‡Øç‡Æï ‡Æ®‡Ææ‡Æ©‡Øç ‡Æá‡Æô‡Øç‡Æï‡Øá ‡Æâ‡Æ§‡Æµ‡ØÅ‡Æï‡Æø‡Æ±‡Øá‡Æ©‡Øç.`,
      Telugu: `‡∞®‡∞Æ‡∞∏‡±ç‡∞ï‡∞æ‡∞∞‡∞Ç ${name}! üëã ‡∞Æ‡±Ä ‡∞™‡±ç‡∞∞‡∞æ‡∞ß‡∞æ‡∞®‡±ç‡∞Ø‡∞§‡∞≤‡±Å ‡∞Æ‡∞∞‡∞ø‡∞Ø‡±Å ‚Çπ${budget} ‡∞¨‡∞°‡±ç‡∞ú‡±Ü‡∞ü‡±ç ‡∞Ü‡∞ß‡∞æ‡∞∞‡∞Ç‡∞ó‡∞æ ‡∞∏‡∞∞‡±à‡∞® ‡∞´‡±ç‡∞∞‡∞æ‡∞Ç‡∞ö‡±à‡∞ú‡±Ä ‡∞Ö‡∞µ‡∞ï‡∞æ‡∞∂‡∞æ‡∞®‡±ç‡∞®‡∞ø ‡∞ï‡∞®‡±Å‡∞ó‡±ä‡∞®‡∞°‡∞Ç‡∞≤‡±ã ‡∞Æ‡±Ä‡∞ï‡±Å ‡∞∏‡∞π‡∞æ‡∞Ø‡∞Ç ‡∞ö‡±á‡∞Ø‡∞°‡∞æ‡∞®‡∞ø‡∞ï‡∞ø ‡∞®‡±á‡∞®‡±Å ‡∞á‡∞ï‡±ç‡∞ï‡∞° ‡∞â‡∞®‡±ç‡∞®‡∞æ‡∞®‡±Å.`
    };
    return greetings[language] || greetings["English"];
  };

  const getRecommendationMessage = (count, language = "English") => {
    const messages = {
      English: `Perfect! Based on your preferences, I found ${count} franchise opportunities that match your criteria. Here are my top recommendations:`,
      Hindi: `‡§¨‡§¢‡§º‡§ø‡§Ø‡§æ! ‡§Ü‡§™‡§ï‡•Ä ‡§™‡§∏‡§Ç‡§¶ ‡§ï‡•á ‡§Ü‡§ß‡§æ‡§∞ ‡§™‡§∞, ‡§Æ‡•Å‡§ù‡•á ${count} ‡§´‡•ç‡§∞‡•à‡§Ç‡§ö‡§æ‡§á‡§ú‡§º‡•Ä ‡§Ö‡§µ‡§∏‡§∞ ‡§Æ‡§ø‡§≤‡•á ‡§ú‡•ã ‡§Ü‡§™‡§ï‡•á ‡§Æ‡§æ‡§®‡§¶‡§Ç‡§°‡•ã‡§Ç ‡§∏‡•á ‡§Æ‡•á‡§≤ ‡§ñ‡§æ‡§§‡•á ‡§π‡•à‡§Ç‡•§ ‡§Ø‡§π‡§æ‡§Å ‡§Æ‡•á‡§∞‡•Ä ‡§∂‡•Ä‡§∞‡•ç‡§∑ ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∂‡•á‡§Ç ‡§π‡•à‡§Ç:`,
      Gujarati: `‡™∏‡™Ç‡™™‡´Ç‡™∞‡´ç‡™£! ‡™§‡™Æ‡™æ‡™∞‡´Ä ‡™™‡™∏‡™Ç‡™¶‡™ó‡´Ä‡™®‡™æ ‡™Ü‡™ß‡™æ‡™∞‡´á, ‡™Æ‡™®‡´á ${count} ‡™´‡´ç‡™∞‡´á‡™®‡´ç‡™ö‡™æ‡™á‡™ù ‡™§‡™ï‡´ã ‡™Æ‡™≥‡´Ä ‡™ú‡´á ‡™§‡™Æ‡™æ‡™∞‡™æ ‡™Æ‡™æ‡™™‡™¶‡™Ç‡™° ‡™∏‡™æ‡™•‡´á ‡™Æ‡´á‡™≥ ‡™ñ‡™æ‡™Ø ‡™õ‡´á. ‡™Ö‡™π‡´Ä‡™Ç ‡™Æ‡™æ‡™∞‡´Ä ‡™ü‡´ã‡™ö‡™®‡´Ä ‡™≠‡™≤‡™æ‡™Æ‡™£‡´ã ‡™õ‡´á:`,
      Marathi: `‡§™‡§∞‡§ø‡§™‡•Ç‡§∞‡•ç‡§£! ‡§§‡•Å‡§Æ‡§ö‡•ç‡§Ø‡§æ ‡§™‡§∏‡§Ç‡§§‡•Ä‡§®‡•Å‡§∏‡§æ‡§∞, ‡§Æ‡§≤‡§æ ${count} ‡§´‡•ç‡§∞‡§Å‡§ö‡§æ‡§Ø‡§ù‡•Ä ‡§∏‡§Ç‡§ß‡•Ä ‡§∏‡§æ‡§™‡§°‡§≤‡•ç‡§Ø‡§æ ‡§ú‡•ç‡§Ø‡§æ ‡§§‡•Å‡§Æ‡§ö‡•ç‡§Ø‡§æ ‡§®‡§ø‡§ï‡§∑‡§æ‡§Ç‡§∂‡•Ä ‡§ú‡•Å‡§≥‡§§‡§æ‡§§. ‡§Ø‡•á‡§•‡•á ‡§Æ‡§æ‡§ù‡•ç‡§Ø‡§æ ‡§ü‡•â‡§™ ‡§∂‡§ø‡§´‡§æ‡§∞‡§∏‡•Ä ‡§Ü‡§π‡•á‡§§:`,
      Tamil: `‡Æö‡Æ∞‡Æø‡ÆØ‡Ææ‡Æï! ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æµ‡Æø‡Æ∞‡ØÅ‡Æ™‡Øç‡Æ™‡Æô‡Øç‡Æï‡Æ≥‡Æø‡Æ©‡Øç ‡ÆÖ‡Æü‡Æø‡Æ™‡Øç‡Æ™‡Æü‡Øà‡ÆØ‡Æø‡Æ≤‡Øç, ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ§‡Øá‡Æµ‡Øà‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ ‡Æ™‡Øä‡Æ∞‡ØÅ‡Æ®‡Øç‡Æ§‡ØÅ‡ÆÆ‡Øç ${count} ‡Æâ‡Æ∞‡Æø‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ≥‡Æ∞‡Øç ‡Æµ‡Ææ‡ÆØ‡Øç‡Æ™‡Øç‡Æ™‡ØÅ‡Æï‡Æ≥‡Øà ‡Æ®‡Ææ‡Æ©‡Øç ‡Æï‡Æ£‡Øç‡Æü‡Øá‡Æ©‡Øç. ‡Æá‡Æ§‡Øã ‡Æé‡Æ©‡Æ§‡ØÅ ‡Æö‡Æø‡Æ±‡Æ®‡Øç‡Æ§ ‡Æ™‡Æ∞‡Æø‡Æ®‡Øç‡Æ§‡ØÅ‡Æ∞‡Øà‡Æï‡Æ≥‡Øç:`,
      Telugu: `‡∞™‡∞∞‡±ç‡∞´‡±Ü‡∞ï‡±ç‡∞ü‡±ç! ‡∞Æ‡±Ä ‡∞™‡±ç‡∞∞‡∞æ‡∞ß‡∞æ‡∞®‡±ç‡∞Ø‡∞§‡∞≤ ‡∞Ü‡∞ß‡∞æ‡∞∞‡∞Ç‡∞ó‡∞æ, ‡∞Æ‡±Ä ‡∞™‡±ç‡∞∞‡∞Æ‡∞æ‡∞£‡∞æ‡∞≤‡∞§‡±ã ‡∞∏‡∞∞‡∞ø‡∞™‡±ã‡∞Ø‡±á ${count} ‡∞´‡±ç‡∞∞‡∞æ‡∞Ç‡∞ö‡±à‡∞ú‡±Ä ‡∞Ö‡∞µ‡∞ï‡∞æ‡∞∂‡∞æ‡∞≤‡±Å ‡∞®‡±á‡∞®‡±Å ‡∞ï‡∞®‡±Å‡∞ó‡±ä‡∞®‡±ç‡∞®‡∞æ‡∞®‡±Å. ‡∞á‡∞¶‡∞ø‡∞ó‡±ã ‡∞®‡∞æ ‡∞ü‡∞æ‡∞™‡±ç ‡∞∏‡∞ø‡∞´‡∞æ‡∞∞‡±ç‡∞∏‡±Å‡∞≤‡±Å:`
    };
    return messages[language] || messages["English"];
  };

  const getNoMatchMessage = (language = "English") => {
    const messages = {
      English: `I couldn't find exact matches for your criteria, but don't worry! Our team will review your preferences and get back to you with personalized recommendations within 24 hours.\n\nIn the meantime, you can browse all available franchises on our platform.`,
      Hindi: `‡§Æ‡•Å‡§ù‡•á ‡§Ü‡§™‡§ï‡•á ‡§Æ‡§æ‡§®‡§¶‡§Ç‡§°‡•ã‡§Ç ‡§ï‡•á ‡§≤‡§ø‡§è ‡§∏‡§ü‡•Ä‡§ï ‡§Æ‡•á‡§≤ ‡§®‡§π‡•Ä‡§Ç ‡§Æ‡§ø‡§≤‡§æ, ‡§≤‡•á‡§ï‡§ø‡§® ‡§ö‡§ø‡§Ç‡§§‡§æ ‡§® ‡§ï‡§∞‡•á‡§Ç! ‡§π‡§Æ‡§æ‡§∞‡•Ä ‡§ü‡•Ä‡§Æ ‡§Ü‡§™‡§ï‡•Ä ‡§™‡§∏‡§Ç‡§¶ ‡§ï‡•Ä ‡§∏‡§Æ‡•Ä‡§ï‡•ç‡§∑‡§æ ‡§ï‡§∞‡•á‡§ó‡•Ä ‡§î‡§∞ 24 ‡§ò‡§Ç‡§ü‡•ã‡§Ç ‡§ï‡•á ‡§≠‡•Ä‡§§‡§∞ ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø‡§ó‡§§ ‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∂‡•ã‡§Ç ‡§ï‡•á ‡§∏‡§æ‡§• ‡§Ü‡§™‡§∏‡•á ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï ‡§ï‡§∞‡•á‡§ó‡•Ä‡•§\n\n‡§á‡§∏ ‡§¨‡•Ä‡§ö, ‡§Ü‡§™ ‡§π‡§Æ‡§æ‡§∞‡•á ‡§™‡•ç‡§≤‡•á‡§ü‡§´‡§º‡•â‡§∞‡•ç‡§Æ ‡§™‡§∞ ‡§∏‡§≠‡•Ä ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§´‡•ç‡§∞‡•à‡§Ç‡§ö‡§æ‡§á‡§ú‡§º‡•Ä ‡§¨‡•ç‡§∞‡§æ‡§â‡§ú‡§º ‡§ï‡§∞ ‡§∏‡§ï‡§§‡•á ‡§π‡•à‡§Ç‡•§`,
      Gujarati: `‡™Æ‡™®‡´á ‡™§‡™Æ‡™æ‡™∞‡™æ ‡™Æ‡™æ‡™™‡™¶‡™Ç‡™° ‡™Æ‡™æ‡™ü‡´á ‡™ö‡´ã‡™ï‡´ç‡™ï‡™∏ ‡™Æ‡´á‡™≥ ‡™Æ‡™≥‡´Ä ‡™∂‡™ï‡´ç‡™Ø‡™æ ‡™®‡™•‡´Ä, ‡™™‡™∞‡™Ç‡™§‡´Å ‡™ö‡™ø‡™Ç‡™§‡™æ ‡™ï‡™∞‡™∂‡´ã ‡™®‡™π‡´Ä‡™Ç! ‡™Ö‡™Æ‡™æ‡™∞‡´Ä ‡™ü‡´Ä‡™Æ ‡™§‡™Æ‡™æ‡™∞‡´Ä ‡™™‡™∏‡™Ç‡™¶‡™ó‡´Ä‡™ì‡™®‡´Ä ‡™∏‡™Æ‡´Ä‡™ï‡´ç‡™∑‡™æ ‡™ï‡™∞‡™∂‡´á ‡™Ö‡™®‡´á 24 ‡™ï‡™≤‡™æ‡™ï‡™®‡´Ä ‡™Ö‡™Ç‡™¶‡™∞ ‡™µ‡´ç‡™Ø‡™ï‡´ç‡™§‡™ø‡™ó‡™§ ‡™≠‡™≤‡™æ‡™Æ‡™£‡´ã ‡™∏‡™æ‡™•‡´á ‡™§‡™Æ‡™æ‡™∞‡´ã ‡™∏‡™Ç‡™™‡™∞‡´ç‡™ï ‡™ï‡™∞‡™∂‡´á.\n\n‡™Æ‡™ß‡´ç‡™Ø‡™∏‡´ç‡™• ‡™∏‡™Æ‡™Ø‡´á, ‡™§‡™Æ‡´á ‡™Ö‡™Æ‡™æ‡™∞‡™æ ‡™™‡´ç‡™≤‡´á‡™ü‡™´‡´ã‡™∞‡´ç‡™Æ ‡™™‡™∞ ‡™â‡™™‡™≤‡™¨‡´ç‡™ß ‡™§‡™Æ‡™æ‡™Æ ‡™´‡´ç‡™∞‡´á‡™®‡´ç‡™ö‡™æ‡™á‡™ù ‡™¨‡´ç‡™∞‡™æ‡™â‡™ù ‡™ï‡™∞‡´Ä ‡™∂‡™ï‡´ã ‡™õ‡´ã.`,
      Marathi: `‡§Æ‡§≤‡§æ ‡§§‡•Å‡§Æ‡§ö‡•ç‡§Ø‡§æ ‡§®‡§ø‡§ï‡§∑‡§æ‡§Ç‡§∏‡§æ‡§†‡•Ä ‡§Ö‡§ö‡•Ç‡§ï ‡§ú‡•Å‡§≥‡§£‡•Ä ‡§∏‡§æ‡§™‡§°‡§≤‡•Ä ‡§®‡§æ‡§π‡•Ä, ‡§™‡§£ ‡§ï‡§æ‡§≥‡§ú‡•Ä ‡§ï‡§∞‡•Ç ‡§®‡§ï‡§æ! ‡§Ü‡§Æ‡§ö‡•Ä ‡§ü‡•Ä‡§Æ ‡§§‡•Å‡§Æ‡§ö‡•ç‡§Ø‡§æ ‡§™‡§∏‡§Ç‡§§‡•Ä‡§Ç‡§ö‡•á ‡§™‡•Å‡§®‡§∞‡§æ‡§µ‡§≤‡•ã‡§ï‡§® ‡§ï‡§∞‡•á‡§≤ ‡§Ü‡§£‡§ø 24 ‡§§‡§æ‡§∏‡§æ‡§Ç‡§ö‡•ç‡§Ø‡§æ ‡§Ü‡§§ ‡§µ‡•à‡§Ø‡§ï‡•ç‡§§‡§ø‡§ï ‡§∂‡§ø‡§´‡§æ‡§∞‡§∂‡•Ä‡§Ç‡§∏‡§π ‡§§‡•Å‡§Æ‡§ö‡•ç‡§Ø‡§æ‡§∂‡•Ä ‡§∏‡§Ç‡§™‡§∞‡•ç‡§ï ‡§∏‡§æ‡§ß‡•á‡§≤.\n\n‡§¶‡§∞‡§Æ‡•ç‡§Ø‡§æ‡§®, ‡§§‡•Å‡§Æ‡•ç‡§π‡•Ä ‡§Ü‡§Æ‡§ö‡•ç‡§Ø‡§æ ‡§™‡•ç‡§≤‡•Ö‡§ü‡§´‡•â‡§∞‡•ç‡§Æ‡§µ‡§∞ ‡§â‡§™‡§≤‡§¨‡•ç‡§ß ‡§∏‡§∞‡•ç‡§µ ‡§´‡•ç‡§∞‡§Å‡§ö‡§æ‡§Ø‡§ù‡•Ä ‡§¨‡•ç‡§∞‡§æ‡§â‡§ù ‡§ï‡§∞‡•Ç ‡§∂‡§ï‡§§‡§æ.`,
      Tamil: `‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ§‡Øá‡Æµ‡Øà‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ ‡Æö‡Æ∞‡Æø‡ÆØ‡Ææ‡Æ© ‡Æ™‡Øä‡Æ∞‡ØÅ‡Æ§‡Øç‡Æ§‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æé‡Æ©‡Æï‡Øç‡Æï‡ØÅ ‡Æï‡Æø‡Æü‡Øà‡Æï‡Øç‡Æï‡Æµ‡Æø‡Æ≤‡Øç‡Æ≤‡Øà, ‡ÆÜ‡Æ©‡Ææ‡Æ≤‡Øç ‡Æï‡Æµ‡Æ≤‡Øà‡Æ™‡Øç‡Æ™‡Æü ‡Æµ‡Øá‡Æ£‡Øç‡Æü‡Ææ‡ÆÆ‡Øç! ‡Æé‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æï‡ØÅ‡Æ¥‡ØÅ ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æµ‡Æø‡Æ∞‡ØÅ‡Æ™‡Øç‡Æ™‡Æô‡Øç‡Æï‡Æ≥‡Øà ‡ÆÆ‡Æ§‡Æø‡Æ™‡Øç‡Æ™‡Ææ‡ÆØ‡Øç‡Æµ‡ØÅ ‡Æö‡ØÜ‡ÆØ‡Øç‡Æ§‡ØÅ 24 ‡ÆÆ‡Æ£‡Æø ‡Æ®‡Øá‡Æ∞‡Æ§‡Øç‡Æ§‡Æø‡Æ±‡Øç‡Æï‡ØÅ‡Æ≥‡Øç ‡Æ§‡Æ©‡Æø‡Æ™‡Øç‡Æ™‡ÆØ‡Æ©‡Øç ‡Æ™‡Æ∞‡Æø‡Æ®‡Øç‡Æ§‡ØÅ‡Æ∞‡Øà‡Æï‡Æ≥‡ØÅ‡Æü‡Æ©‡Øç ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øà‡Æ§‡Øç ‡Æ§‡Øä‡Æü‡Æ∞‡Øç‡Æ™‡ØÅ ‡Æï‡Øä‡Æ≥‡Øç‡Æ≥‡ØÅ‡ÆÆ‡Øç.\n\n‡Æá‡Æ§‡Æ±‡Øç‡Æï‡Æø‡Æü‡Øà‡ÆØ‡Æø‡Æ≤‡Øç, ‡Æé‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ§‡Æ≥‡Æ§‡Øç‡Æ§‡Æø‡Æ≤‡Øç ‡Æï‡Æø‡Æü‡Øà‡Æï‡Øç‡Æï‡ØÅ‡ÆÆ‡Øç ‡ÆÖ‡Æ©‡Øà‡Æ§‡Øç‡Æ§‡ØÅ ‡Æâ‡Æ∞‡Æø‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ≥‡Æ∞‡Øç‡Æï‡Æ≥‡Øà‡ÆØ‡ØÅ‡ÆÆ‡Øç ‡Æ®‡ØÄ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ™‡Ææ‡Æ∞‡Øç‡Æï‡Øç‡Æï‡Æ≤‡Ææ‡ÆÆ‡Øç.`,
      Telugu: `‡∞Æ‡±Ä ‡∞™‡±ç‡∞∞‡∞Æ‡∞æ‡∞£‡∞æ‡∞≤‡∞ï‡±Å ‡∞∏‡∞∞‡∞ø‡∞ó‡±ç‡∞ó‡∞æ ‡∞∏‡∞∞‡∞ø‡∞™‡±ã‡∞Ø‡±á‡∞µ‡∞ø ‡∞®‡∞æ‡∞ï‡±Å ‡∞ï‡∞®‡∞ø‡∞™‡∞ø‡∞Ç‡∞ö‡∞≤‡±á‡∞¶‡±Å, ‡∞ï‡∞æ‡∞®‡±Ä ‡∞ö‡∞ø‡∞Ç‡∞§‡∞ø‡∞Ç‡∞ö‡∞ï‡∞Ç‡∞°‡∞ø! ‡∞Æ‡∞æ ‡∞¨‡±É‡∞Ç‡∞¶‡∞Ç ‡∞Æ‡±Ä ‡∞™‡±ç‡∞∞‡∞æ‡∞ß‡∞æ‡∞®‡±ç‡∞Ø‡∞§‡∞≤‡∞®‡±Å ‡∞∏‡∞Æ‡±Ä‡∞ï‡±ç‡∞∑‡∞ø‡∞Ç‡∞ö‡∞ø 24 ‡∞ó‡∞Ç‡∞ü‡∞≤‡±ç‡∞≤‡±ã ‡∞µ‡±ç‡∞Ø‡∞ï‡±ç‡∞§‡∞ø‡∞ó‡∞§ ‡∞∏‡∞ø‡∞´‡∞æ‡∞∞‡±ç‡∞∏‡±Å‡∞≤‡∞§‡±ã ‡∞Æ‡∞ø‡∞Æ‡±ç‡∞Æ‡∞≤‡±ç‡∞®‡∞ø ‡∞∏‡∞Ç‡∞™‡±ç‡∞∞‡∞¶‡∞ø‡∞∏‡±ç‡∞§‡±Å‡∞Ç‡∞¶‡∞ø.\n\n‡∞à ‡∞Æ‡∞ß‡±ç‡∞Ø‡∞ï‡∞æ‡∞≤‡∞Ç‡∞≤‡±ã, ‡∞Æ‡±Ä‡∞∞‡±Å ‡∞Æ‡∞æ ‡∞™‡±ç‡∞≤‡∞æ‡∞ü‡±ç‚Äå‡∞´‡∞æ‡∞∞‡∞Æ‡±ç‚Äå‡∞≤‡±ã ‡∞Ö‡∞Ç‡∞¶‡±Å‡∞¨‡∞æ‡∞ü‡±Å‡∞≤‡±ã ‡∞â‡∞®‡±ç‡∞® ‡∞Ö‡∞®‡±ç‡∞®‡∞ø ‡∞´‡±ç‡∞∞‡∞æ‡∞Ç‡∞ö‡±à‡∞ú‡±Ä‡∞≤‡∞®‡±Å ‡∞¨‡±ç‡∞∞‡±å‡∞ú‡±ç ‡∞ö‡±á‡∞Ø‡∞µ‡∞ö‡±ç‡∞ö‡±Å.`
    };
    return messages[language] || messages["English"];
  };

  const getButtonText = (buttonType, language = "English") => {
    const texts = {
      viewDetails: {
        English: "View Details & Inquire",
        Hindi: "‡§µ‡§ø‡§µ‡§∞‡§£ ‡§¶‡•á‡§ñ‡•á‡§Ç ‡§î‡§∞ ‡§™‡•Ç‡§õ‡§§‡§æ‡§õ ‡§ï‡§∞‡•á‡§Ç",
        Gujarati: "‡™µ‡™ø‡™ó‡™§‡´ã ‡™ú‡´Å‡™ì ‡™Ö‡™®‡´á ‡™™‡´Ç‡™õ‡™™‡™∞‡™õ ‡™ï‡™∞‡´ã",
        Marathi: "‡§§‡§™‡§∂‡•Ä‡§≤ ‡§™‡§π‡§æ ‡§Ü‡§£‡§ø ‡§ö‡•å‡§ï‡§∂‡•Ä ‡§ï‡§∞‡§æ",
        Tamil: "‡Æµ‡Æø‡Æµ‡Æ∞‡Æô‡Øç‡Æï‡Æ≥‡Øà‡Æ™‡Øç ‡Æ™‡Ææ‡Æ∞‡Øç‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡Æµ‡Æø‡Æö‡Ææ‡Æ∞‡Æø‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç",
        Telugu: "‡∞µ‡∞ø‡∞µ‡∞∞‡∞æ‡∞≤‡±Å ‡∞ö‡±Ç‡∞°‡∞Ç‡∞°‡∞ø ‡∞Æ‡∞∞‡∞ø‡∞Ø‡±Å ‡∞µ‡∞ø‡∞ö‡∞æ‡∞∞‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø"
      },
      browseAll: {
        English: "Browse All Franchises",
        Hindi: "‡§∏‡§≠‡•Ä ‡§´‡•ç‡§∞‡•à‡§Ç‡§ö‡§æ‡§á‡§ú‡§º‡•Ä ‡§¨‡•ç‡§∞‡§æ‡§â‡§ú‡§º ‡§ï‡§∞‡•á‡§Ç",
        Gujarati: "‡™§‡™Æ‡™æ‡™Æ ‡™´‡´ç‡™∞‡´á‡™®‡´ç‡™ö‡™æ‡™á‡™ù ‡™¨‡´ç‡™∞‡™æ‡™â‡™ù ‡™ï‡™∞‡´ã",
        Marathi: "‡§∏‡§∞‡•ç‡§µ ‡§´‡•ç‡§∞‡§Å‡§ö‡§æ‡§Ø‡§ù‡•Ä ‡§¨‡•ç‡§∞‡§æ‡§â‡§ù ‡§ï‡§∞‡§æ",
        Tamil: "‡ÆÖ‡Æ©‡Øà‡Æ§‡Øç‡Æ§‡ØÅ ‡Æâ‡Æ∞‡Æø‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ≥‡Æ∞‡Øç‡Æï‡Æ≥‡Øà‡ÆØ‡ØÅ‡ÆÆ‡Øç ‡Æ™‡Ææ‡Æ∞‡Øç‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç",
        Telugu: "‡∞Ö‡∞®‡±ç‡∞®‡∞ø ‡∞´‡±ç‡∞∞‡∞æ‡∞Ç‡∞ö‡±à‡∞ú‡±Ä‡∞≤‡∞®‡±Å ‡∞¨‡±ç‡∞∞‡±å‡∞ú‡±ç ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø"
      },
      opensInNewTab: {
        English: "Opens in new tab",
        Hindi: "‡§®‡§è ‡§ü‡•à‡§¨ ‡§Æ‡•á‡§Ç ‡§ñ‡•Å‡§≤‡§§‡§æ ‡§π‡•à",
        Gujarati: "‡™®‡™µ‡™æ ‡™ü‡´á‡™¨‡™Æ‡™æ‡™Ç ‡™ñ‡´Å‡™≤‡´á ‡™õ‡´á",
        Marathi: "‡§®‡§µ‡•Ä‡§® ‡§ü‡•Ö‡§¨‡§Æ‡§ß‡•ç‡§Ø‡•á ‡§â‡§ò‡§°‡§§‡•á",
        Tamil: "‡Æ™‡ØÅ‡Æ§‡Æø‡ÆØ ‡Æ§‡Ææ‡Æµ‡Æ≤‡Æø‡Æ≤‡Øç ‡Æ§‡Æø‡Æ±‡Æï‡Øç‡Æï‡Æø‡Æ±‡Æ§‡ØÅ",
        Telugu: "‡∞ï‡±ä‡∞§‡±ç‡∞§ ‡∞ü‡±ç‡∞Ø‡∞æ‡∞¨‡±ç‚Äå‡∞≤‡±ã ‡∞§‡±Ü‡∞∞‡±Å‡∞ö‡±Å‡∞ï‡±Å‡∞Ç‡∞ü‡±Å‡∞Ç‡∞¶‡∞ø"
      }
    };
    return texts[buttonType]?.[language] || texts[buttonType]?.["English"] || "";
  };

  const saveChatLead = async (responses, userInfo) => {
    try {
      const chatLeadsCollection = collection(db, "chatLeads");
      const leadData = {
        userInfo: userInfo,
        responses: responses,
        createdAt: serverTimestamp(),
        status: "New",
        source: "chatbot",
        matchedBrands: matchedBrands.map(b => ({
          brandId: b.id,
          brandName: b.brandName,
          matchScore: b.matchScore,
          matchReasons: b.matchReasons
        }))
      };
      
      const docRef = await addDoc(chatLeadsCollection, leadData);
      
      // Send notification to admins about new chat lead
      await NotificationService.sendAdminNotification(
        `New chat lead from ${userInfo?.name || 'Anonymous'} - Interested in ${responses.industry}`,
        {
          type: "chat_lead",
          leadId: docRef.id,
          prospectName: userInfo?.name,
          location: userInfo?.location,
          budget: userInfo?.budget,
          industry: responses.industry
        }
      );
      
      return docRef.id;
    } catch (error) {
      logger.error("Error saving chat lead:", error);
    }
  };

  // Updated question flow with franchise-specific questions
  const getQuestionData = (step, language = "English") => {
    const questions = {
      1: {
        English: {
          question: "Which industry interests you most for franchise investment?",
          options: [
            { key: "food", label: "Food & Beverage", description: "Restaurants, Cafes, Quick Service" },
            { key: "retail", label: "Retail", description: "Clothing, Electronics, Consumer Goods" },
            { key: "healthcare", label: "Healthcare", description: "Clinics, Wellness Centers, Pharmacies" },
            { key: "education", label: "Education", description: "Coaching, Training, Schools" },
            { key: "fitness", label: "Fitness", description: "Gyms, Yoga Studios, Sports" },
            { key: "beauty", label: "Beauty & Wellness", description: "Salons, Spas, Beauty Services" },
            { key: "services", label: "Services", description: "Cleaning, Repair, Consulting" },
            { key: "other", label: "Other", description: "Explore other opportunities" }
          ]
        },
        Hindi: {
          question: "‡§´‡•ç‡§∞‡•à‡§Ç‡§ö‡§æ‡§á‡§ú‡§º‡•Ä ‡§®‡§ø‡§µ‡•á‡§∂ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§™‡§ï‡•ã ‡§ï‡•å‡§® ‡§∏‡§æ ‡§â‡§¶‡•ç‡§Ø‡•ã‡§ó ‡§∏‡§¨‡§∏‡•á ‡§Ö‡§ß‡§ø‡§ï ‡§∞‡•Å‡§ö‡§ø‡§ï‡§∞ ‡§≤‡§ó‡§§‡§æ ‡§π‡•à?",
          options: [
            { key: "food", label: "‡§ñ‡§æ‡§¶‡•ç‡§Ø ‡§î‡§∞ ‡§™‡•á‡§Ø", description: "‡§∞‡•á‡§∏‡•ç‡§ü‡•ã‡§∞‡•á‡§Ç‡§ü, ‡§ï‡•à‡§´‡•á, ‡§§‡•ç‡§µ‡§∞‡§ø‡§§ ‡§∏‡•á‡§µ‡§æ" },
            { key: "retail", label: "‡§∞‡§ø‡§ü‡•á‡§≤", description: "‡§ï‡§™‡§°‡§º‡•á, ‡§á‡§≤‡•á‡§ï‡•ç‡§ü‡•ç‡§∞‡•â‡§®‡§ø‡§ï‡•ç‡§∏, ‡§â‡§™‡§≠‡•ã‡§ï‡•ç‡§§‡§æ ‡§µ‡§∏‡•ç‡§§‡•Å‡§è‡§Ç" },
            { key: "healthcare", label: "‡§∏‡•ç‡§µ‡§æ‡§∏‡•ç‡§•‡•ç‡§Ø ‡§∏‡•á‡§µ‡§æ", description: "‡§ï‡•ç‡§≤‡§ø‡§®‡§ø‡§ï, ‡§µ‡•á‡§≤‡§®‡•á‡§∏ ‡§∏‡•á‡§Ç‡§ü‡§∞, ‡§´‡§æ‡§∞‡•ç‡§Æ‡•á‡§∏‡•Ä" },
            { key: "education", label: "‡§∂‡§ø‡§ï‡•ç‡§∑‡§æ", description: "‡§ï‡•ã‡§ö‡§ø‡§Ç‡§ó, ‡§™‡•ç‡§∞‡§∂‡§ø‡§ï‡•ç‡§∑‡§£, ‡§∏‡•ç‡§ï‡•Ç‡§≤" },
            { key: "fitness", label: "‡§´‡§ø‡§ü‡§®‡•á‡§∏", description: "‡§ú‡§ø‡§Æ, ‡§Ø‡•ã‡§ó ‡§∏‡•ç‡§ü‡•Ç‡§°‡§ø‡§Ø‡•ã, ‡§ñ‡•á‡§≤" },
            { key: "beauty", label: "‡§∏‡•å‡§Ç‡§¶‡§∞‡•ç‡§Ø ‡§î‡§∞ ‡§ï‡§≤‡•ç‡§Ø‡§æ‡§£", description: "‡§∏‡•à‡§≤‡•Ç‡§®, ‡§∏‡•ç‡§™‡§æ, ‡§∏‡•å‡§Ç‡§¶‡§∞‡•ç‡§Ø ‡§∏‡•á‡§µ‡§æ‡§è‡§Ç" },
            { key: "services", label: "‡§∏‡•á‡§µ‡§æ‡§è‡§Ç", description: "‡§∏‡§´‡§æ‡§à, ‡§Æ‡§∞‡§Æ‡•ç‡§Æ‡§§, ‡§™‡§∞‡§æ‡§Æ‡§∞‡•ç‡§∂" },
            { key: "other", label: "‡§Ö‡§®‡•ç‡§Ø", description: "‡§Ö‡§®‡•ç‡§Ø ‡§Ö‡§µ‡§∏‡§∞‡•ã‡§Ç ‡§ï‡§æ ‡§Ö‡§®‡•ç‡§µ‡•á‡§∑‡§£ ‡§ï‡§∞‡•á‡§Ç" }
          ]
        },
        Gujarati: {
          question: "‡™´‡´ç‡™∞‡´á‡™®‡´ç‡™ö‡™æ‡™á‡™ù ‡™∞‡´ã‡™ï‡™æ‡™£ ‡™Æ‡™æ‡™ü‡´á ‡™§‡™Æ‡™®‡´á ‡™ï‡™Ø‡™æ ‡™â‡™¶‡´ç‡™Ø‡´ã‡™ó‡™Æ‡™æ‡™Ç ‡™∏‡´å‡™•‡´Ä ‡™µ‡™ß‡´Å ‡™∞‡™∏ ‡™õ‡´á?",
          options: [
            { key: "food", label: "‡™ñ‡´ã‡™∞‡™æ‡™ï ‡™Ö‡™®‡´á ‡™™‡´Ä‡™£‡™æ‡™Ç", description: "‡™∞‡´á‡™∏‡´ç‡™ü‡´ã‡™∞‡™®‡´ç‡™ü, ‡™ï‡™æ‡™´‡´á, ‡™ù‡™°‡™™‡´Ä ‡™∏‡´á‡™µ‡™æ" },
            { key: "retail", label: "‡™∞‡™ø‡™ü‡´á‡™≤", description: "‡™ï‡™™‡™°‡™æ‡™Ç, ‡™á‡™≤‡´á‡™ï‡´ç‡™ü‡´ç‡™∞‡´ã‡™®‡™ø‡™ï‡´ç‡™∏, ‡™ó‡´ç‡™∞‡™æ‡™π‡™ï ‡™ö‡´Ä‡™ú‡™µ‡™∏‡´ç‡™§‡´Å‡™ì" },
            { key: "healthcare", label: "‡™Ü‡™∞‡´ã‡™ó‡´ç‡™Ø‡™∏‡´á‡™µ‡™æ", description: "‡™ï‡´ç‡™≤‡™ø‡™®‡™ø‡™ï, ‡™µ‡´á‡™≤‡™®‡´á‡™∏ ‡™∏‡´á‡™®‡´ç‡™ü‡™∞, ‡™´‡™æ‡™∞‡´ç‡™Æ‡™∏‡´Ä" },
            { key: "education", label: "‡™∂‡™ø‡™ï‡´ç‡™∑‡™£", description: "‡™ï‡´ã‡™ö‡™ø‡™Ç‡™ó, ‡™§‡™æ‡™≤‡´Ä‡™Æ, ‡™∂‡™æ‡™≥‡™æ‡™ì" },
            { key: "fitness", label: "‡™´‡™ø‡™ü‡™®‡´á‡™∏", description: "‡™ú‡™ø‡™Æ, ‡™Ø‡´ã‡™ó ‡™∏‡´ç‡™ü‡´Å‡™°‡™ø‡™Ø‡´ã, ‡™∞‡™Æ‡™§‡´ã" },
            { key: "beauty", label: "‡™∏‡´å‡™Ç‡™¶‡™∞‡´ç‡™Ø ‡™Ö‡™®‡´á ‡™ï‡™≤‡´ç‡™Ø‡™æ‡™£", description: "‡™∏‡™≤‡´Ç‡™®, ‡™∏‡´ç‡™™‡™æ, ‡™∏‡´å‡™Ç‡™¶‡™∞‡´ç‡™Ø ‡™∏‡´á‡™µ‡™æ‡™ì" },
            { key: "services", label: "‡™∏‡´á‡™µ‡™æ‡™ì", description: "‡™∏‡™´‡™æ‡™à, ‡™∏‡™Æ‡™æ‡™∞‡™ï‡™æ‡™Æ, ‡™™‡™∞‡™æ‡™Æ‡™∞‡´ç‡™∂" },
            { key: "other", label: "‡™Ö‡™®‡´ç‡™Ø", description: "‡™Ö‡™®‡´ç‡™Ø ‡™§‡™ï‡´ã‡™®‡´Å‡™Ç ‡™Ö‡™®‡´ç‡™µ‡´á‡™∑‡™£ ‡™ï‡™∞‡´ã" }
          ]
        },
        Marathi: {
          question: "‡§´‡•ç‡§∞‡§Å‡§ö‡§æ‡§Ø‡§ù‡•Ä ‡§ó‡•Å‡§Ç‡§§‡§µ‡§£‡•Å‡§ï‡•Ä‡§∏‡§æ‡§†‡•Ä ‡§§‡•Å‡§Æ‡•ç‡§π‡§æ‡§≤‡§æ ‡§ï‡•ã‡§£‡§§‡•ç‡§Ø‡§æ ‡§â‡§¶‡•ç‡§Ø‡•ã‡§ó‡§æ‡§§ ‡§∏‡§∞‡•ç‡§µ‡§æ‡§ß‡§ø‡§ï ‡§∞‡§∏ ‡§Ü‡§π‡•á?",
          options: [
            { key: "food", label: "‡§Ö‡§®‡•ç‡§® ‡§Ü‡§£‡§ø ‡§™‡•á‡§Ø", description: "‡§∞‡•á‡§∏‡•ç‡§ü‡•â‡§∞‡§Ç‡§ü, ‡§ï‡•Ö‡§´‡•á, ‡§¶‡•ç‡§∞‡•Å‡§§ ‡§∏‡•á‡§µ‡§æ" },
            { key: "retail", label: "‡§ï‡§ø‡§∞‡§ï‡•ã‡§≥", description: "‡§ï‡§™‡§°‡•á, ‡§á‡§≤‡•á‡§ï‡•ç‡§ü‡•ç‡§∞‡•â‡§®‡§ø‡§ï‡•ç‡§∏, ‡§ó‡•ç‡§∞‡§æ‡§π‡§ï ‡§µ‡§∏‡•ç‡§§‡•Ç" },
            { key: "healthcare", label: "‡§Ü‡§∞‡•ã‡§ó‡•ç‡§Ø‡§∏‡•á‡§µ‡§æ", description: "‡§ï‡•ç‡§≤‡§ø‡§®‡§ø‡§ï, ‡§µ‡•á‡§≤‡§®‡•á‡§∏ ‡§∏‡•á‡§Ç‡§ü‡§∞, ‡§´‡§æ‡§∞‡•ç‡§Æ‡§∏‡•Ä" },
            { key: "education", label: "‡§∂‡§ø‡§ï‡•ç‡§∑‡§£", description: "‡§ï‡•ã‡§ö‡§ø‡§Ç‡§ó, ‡§™‡•ç‡§∞‡§∂‡§ø‡§ï‡•ç‡§∑‡§£, ‡§∂‡§æ‡§≥‡§æ" },
            { key: "fitness", label: "‡§´‡§ø‡§ü‡§®‡•á‡§∏", description: "‡§ú‡§ø‡§Æ, ‡§Ø‡•ã‡§ó ‡§∏‡•ç‡§ü‡•Å‡§°‡§ø‡§ì, ‡§ñ‡•á‡§≥" },
            { key: "beauty", label: "‡§∏‡•å‡§Ç‡§¶‡§∞‡•ç‡§Ø ‡§Ü‡§£‡§ø ‡§®‡§ø‡§∞‡•ã‡§ó‡•Ä‡§™‡§£‡§æ", description: "‡§∏‡§≤‡•Ç‡§®, ‡§∏‡•ç‡§™‡§æ, ‡§∏‡•å‡§Ç‡§¶‡§∞‡•ç‡§Ø ‡§∏‡•á‡§µ‡§æ" },
            { key: "services", label: "‡§∏‡•á‡§µ‡§æ", description: "‡§∏‡•ç‡§µ‡§ö‡•ç‡§õ‡§§‡§æ, ‡§¶‡•Å‡§∞‡•Å‡§∏‡•ç‡§§‡•Ä, ‡§∏‡§≤‡•ç‡§≤‡§æ‡§Æ‡§∏‡§≤‡§§" },
            { key: "other", label: "‡§á‡§§‡§∞", description: "‡§á‡§§‡§∞ ‡§∏‡§Ç‡§ß‡•Ä‡§Ç‡§ö‡§æ ‡§∂‡•ã‡§ß ‡§ò‡•ç‡§Ø‡§æ" }
          ]
        },
        Tamil: {
          question: "‡Æâ‡Æ∞‡Æø‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ≥‡Æ∞‡Øç ‡ÆÆ‡ØÅ‡Æ§‡Æ≤‡ØÄ‡Æü‡Øç‡Æü‡Æø‡Æ±‡Øç‡Æï‡ØÅ ‡Æé‡Æ®‡Øç‡Æ§‡Æ§‡Øç ‡Æ§‡ØÅ‡Æ±‡Øà ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ ‡ÆÖ‡Æ§‡Æø‡Æï ‡ÆÜ‡Æ∞‡Øç‡Æµ‡ÆÆ‡Ææ‡Æï ‡Æâ‡Æ≥‡Øç‡Æ≥‡Æ§‡ØÅ?",
          options: [
            { key: "food", label: "‡Æâ‡Æ£‡Æµ‡ØÅ ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡Æ™‡Ææ‡Æ©‡ÆÆ‡Øç", description: "‡Æâ‡Æ£‡Æµ‡Æï‡Æô‡Øç‡Æï‡Æ≥‡Øç, ‡Æï‡ÆÉ‡Æ™‡Øá, ‡Æµ‡Æø‡Æ∞‡Øà‡Æµ‡ØÅ ‡Æö‡Øá‡Æµ‡Øà" },
            { key: "retail", label: "‡Æö‡Æø‡Æ≤‡Øç‡Æ≤‡Æ±‡Øà", description: "‡ÆÜ‡Æü‡Øà, ‡ÆÆ‡Æø‡Æ©‡Øç‡Æ©‡Æ£‡ØÅ‡Æµ‡Æø‡ÆØ‡Æ≤‡Øç, ‡Æ®‡ØÅ‡Æï‡Æ∞‡Øç‡Æµ‡Øã‡Æ∞‡Øç ‡Æ™‡Øä‡Æ∞‡ØÅ‡Æü‡Øç‡Æï‡Æ≥‡Øç" },
            { key: "healthcare", label: "‡Æö‡ØÅ‡Æï‡Ææ‡Æ§‡Ææ‡Æ∞‡ÆÆ‡Øç", description: "‡ÆÆ‡Æ∞‡ØÅ‡Æ§‡Øç‡Æ§‡ØÅ‡Æµ‡ÆÆ‡Æ©‡Øà‡Æï‡Æ≥‡Øç, ‡Æµ‡ØÜ‡Æ≤‡Øç‡Æ©‡ØÜ‡Æ∏‡Øç ‡ÆÆ‡Øà‡ÆØ‡Æô‡Øç‡Æï‡Æ≥‡Øç, ‡ÆÆ‡Æ∞‡ØÅ‡Æ®‡Øç‡Æ§‡Æï‡Æô‡Øç‡Æï‡Æ≥‡Øç" },
            { key: "education", label: "‡Æï‡Æ≤‡Øç‡Æµ‡Æø", description: "‡Æ™‡ÆØ‡Æø‡Æ±‡Øç‡Æö‡Æø, ‡Æ™‡ÆØ‡Æø‡Æ±‡Øç‡Æö‡Æø ‡ÆÆ‡Øà‡ÆØ‡Æô‡Øç‡Æï‡Æ≥‡Øç, ‡Æ™‡Æ≥‡Øç‡Æ≥‡Æø‡Æï‡Æ≥‡Øç" },
            { key: "fitness", label: "‡Æâ‡Æü‡Æ±‡Øç‡Æ™‡ÆØ‡Æø‡Æ±‡Øç‡Æö‡Æø", description: "‡Æú‡Æø‡ÆÆ‡Øç, ‡ÆØ‡Øã‡Æï‡Ææ ‡Æ∏‡Øç‡Æü‡ØÅ‡Æü‡Æø‡ÆØ‡Øã, ‡Æµ‡Æø‡Æ≥‡Øà‡ÆØ‡Ææ‡Æü‡Øç‡Æü‡ØÅ" },
            { key: "beauty", label: "‡ÆÖ‡Æ¥‡Æï‡ØÅ ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡ÆÜ‡Æ∞‡Øã‡Æï‡Øç‡Æï‡Æø‡ÆØ‡ÆÆ‡Øç", description: "‡Æö‡Æ≤‡ØÇ‡Æ©‡Øç‡Æï‡Æ≥‡Øç, ‡Æ∏‡Øç‡Æ™‡Ææ, ‡ÆÖ‡Æ¥‡Æï‡ØÅ ‡Æö‡Øá‡Æµ‡Øà‡Æï‡Æ≥‡Øç" },
            { key: "services", label: "‡Æö‡Øá‡Æµ‡Øà‡Æï‡Æ≥‡Øç", description: "‡Æö‡ØÅ‡Æ§‡Øç‡Æ§‡ÆÆ‡Øç, ‡Æ™‡Æ¥‡ØÅ‡Æ§‡ØÅ‡Æ™‡Ææ‡Æ∞‡Øç‡Æ§‡Øç‡Æ§‡Æ≤‡Øç, ‡ÆÜ‡Æ≤‡Øã‡Æö‡Æ©‡Øà" },
            { key: "other", label: "‡ÆÆ‡Æ±‡Øç‡Æ±‡Æµ‡Øà", description: "‡Æ™‡Æø‡Æ± ‡Æµ‡Ææ‡ÆØ‡Øç‡Æ™‡Øç‡Æ™‡ØÅ‡Æï‡Æ≥‡Øà ‡ÆÜ‡Æ∞‡Ææ‡ÆØ‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç" }
          ]
        },
        Telugu: {
          question: "‡∞´‡±ç‡∞∞‡∞æ‡∞Ç‡∞ö‡±à‡∞ú‡±Ä ‡∞™‡±Ü‡∞ü‡±ç‡∞ü‡±Å‡∞¨‡∞°‡∞ø‡∞ï‡∞ø ‡∞Æ‡±Ä‡∞ï‡±Å ‡∞è ‡∞™‡∞∞‡∞ø‡∞∂‡±ç‡∞∞‡∞Æ‡∞≤‡±ã ‡∞é‡∞ï‡±ç‡∞ï‡±Å‡∞µ ‡∞Ü‡∞∏‡∞ï‡±ç‡∞§‡∞ø ‡∞â‡∞Ç‡∞¶‡∞ø?",
          options: [
            { key: "food", label: "‡∞Ü‡∞π‡∞æ‡∞∞‡∞Ç ‡∞Æ‡∞∞‡∞ø‡∞Ø‡±Å ‡∞™‡∞æ‡∞®‡±Ä‡∞Ø‡∞æ‡∞≤‡±Å", description: "‡∞∞‡±Ü‡∞∏‡±ç‡∞ü‡∞æ‡∞∞‡±Ü‡∞Ç‡∞ü‡±ç‡∞≤‡±Å, ‡∞ï‡±á‡∞´‡±ç‚Äå‡∞≤‡±Å, ‡∞§‡±ç‡∞µ‡∞∞‡∞ø‡∞§ ‡∞∏‡±á‡∞µ" },
            { key: "retail", label: "‡∞∞‡∞ø‡∞ü‡±à‡∞≤‡±ç", description: "‡∞µ‡∞∏‡±ç‡∞§‡±ç‡∞∞‡∞æ‡∞≤‡±Å, ‡∞é‡∞≤‡∞ï‡±ç‡∞ü‡±ç‡∞∞‡∞æ‡∞®‡∞ø‡∞ï‡±ç‡∞∏‡±ç, ‡∞µ‡∞ø‡∞®‡∞ø‡∞Ø‡±ã‡∞ó‡∞¶‡∞æ‡∞∞‡±Å ‡∞µ‡∞∏‡±ç‡∞§‡±Å‡∞µ‡±Å‡∞≤‡±Å" },
            { key: "healthcare", label: "‡∞Ü‡∞∞‡±ã‡∞ó‡±ç‡∞Ø ‡∞∏‡∞Ç‡∞∞‡∞ï‡±ç‡∞∑‡∞£", description: "‡∞ï‡±ç‡∞≤‡∞ø‡∞®‡∞ø‡∞ï‡±ç‚Äå‡∞≤‡±Å, ‡∞µ‡±Ü‡∞≤‡±ç‚Äå‡∞®‡±Ü‡∞∏‡±ç ‡∞∏‡±Ü‡∞Ç‡∞ü‡∞∞‡±ç‡∞≤‡±Å, ‡∞´‡∞æ‡∞∞‡±ç‡∞Æ‡∞∏‡±Ä‡∞≤‡±Å" },
            { key: "education", label: "‡∞µ‡∞ø‡∞¶‡±ç‡∞Ø", description: "‡∞ï‡±ã‡∞ö‡∞ø‡∞Ç‡∞ó‡±ç, ‡∞∂‡∞ø‡∞ï‡±ç‡∞∑‡∞£, ‡∞™‡∞æ‡∞†‡∞∂‡∞æ‡∞≤‡∞≤‡±Å" },
            { key: "fitness", label: "‡∞´‡∞ø‡∞ü‡±ç‚Äå‡∞®‡±Ü‡∞∏‡±ç", description: "‡∞ú‡∞ø‡∞Æ‡±ç‚Äå‡∞≤‡±Å, ‡∞Ø‡±ã‡∞ó‡∞æ ‡∞∏‡±ç‡∞ü‡±Ç‡∞°‡∞ø‡∞Ø‡±ã‡∞≤‡±Å, ‡∞ï‡±ç‡∞∞‡±Ä‡∞°‡∞≤‡±Å" },
            { key: "beauty", label: "‡∞Ö‡∞Ç‡∞¶‡∞Ç ‡∞Æ‡∞∞‡∞ø‡∞Ø‡±Å ‡∞Ü‡∞∞‡±ã‡∞ó‡±ç‡∞Ø‡∞Ç", description: "‡∞∏‡∞≤‡±Ç‡∞®‡±ç‡∞≤‡±Å, ‡∞∏‡±ç‡∞™‡∞æ‡∞≤‡±Å, ‡∞Ö‡∞Ç‡∞¶‡∞Ç ‡∞∏‡±á‡∞µ‡∞≤‡±Å" },
            { key: "services", label: "‡∞∏‡±á‡∞µ‡∞≤‡±Å", description: "‡∞∂‡±Å‡∞≠‡±ç‡∞∞‡∞™‡∞∞‡∞ö‡∞°‡∞Ç, ‡∞Æ‡∞∞‡∞Æ‡±ç‡∞Æ‡∞§‡±ç‡∞§‡±Å, ‡∞∏‡∞≤‡∞π‡∞æ" },
            { key: "other", label: "‡∞á‡∞§‡∞∞", description: "‡∞á‡∞§‡∞∞ ‡∞Ö‡∞µ‡∞ï‡∞æ‡∞∂‡∞æ‡∞≤‡∞®‡±Å ‡∞Ö‡∞®‡±ç‡∞µ‡±á‡∞∑‡∞ø‡∞Ç‡∞ö‡∞Ç‡∞°‡∞ø" }
          ]
        }
      },
      2: {
        English: {
          question: "What's your business experience level?",
          options: [
            { key: "none", label: "No Business Experience", description: "First-time entrepreneur" },
            { key: "some", label: "Some Business Experience", description: "1-3 years in business" },
            { key: "experienced", label: "Experienced", description: "3+ years running a business" },
            { key: "franchise", label: "Franchise Experience", description: "Previously owned franchises" }
          ]
        },
        Hindi: {
          question: "‡§Ü‡§™‡§ï‡§æ ‡§µ‡•ç‡§Ø‡§æ‡§µ‡§∏‡§æ‡§Ø‡§ø‡§ï ‡§Ö‡§®‡•Å‡§≠‡§µ ‡§ï‡§æ ‡§∏‡•ç‡§§‡§∞ ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à?",
          options: [
            { key: "none", label: "‡§ï‡•ã‡§à ‡§µ‡•ç‡§Ø‡§æ‡§µ‡§∏‡§æ‡§Ø‡§ø‡§ï ‡§Ö‡§®‡•Å‡§≠‡§µ ‡§®‡§π‡•Ä‡§Ç", description: "‡§™‡§π‡§≤‡•Ä ‡§¨‡§æ‡§∞ ‡§â‡§¶‡•ç‡§Ø‡§Æ‡•Ä" },
            { key: "some", label: "‡§ï‡•Å‡§õ ‡§µ‡•ç‡§Ø‡§æ‡§µ‡§∏‡§æ‡§Ø‡§ø‡§ï ‡§Ö‡§®‡•Å‡§≠‡§µ", description: "‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø ‡§Æ‡•á‡§Ç 1-3 ‡§∏‡§æ‡§≤" },
            { key: "experienced", label: "‡§Ö‡§®‡•Å‡§≠‡§µ‡•Ä", description: "3+ ‡§∏‡§æ‡§≤ ‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø ‡§ö‡§≤‡§æ‡§®‡•á ‡§ï‡§æ ‡§Ö‡§®‡•Å‡§≠‡§µ" },
            { key: "franchise", label: "‡§´‡•ç‡§∞‡•à‡§Ç‡§ö‡§æ‡§á‡§ú‡§º‡•Ä ‡§Ö‡§®‡•Å‡§≠‡§µ", description: "‡§™‡§π‡§≤‡•á ‡§´‡•ç‡§∞‡•à‡§Ç‡§ö‡§æ‡§á‡§ú‡§º‡•Ä ‡§ï‡§æ ‡§Æ‡§æ‡§≤‡§ø‡§ï ‡§∞‡§π‡§æ ‡§π‡•à" }
          ]
        },
        Gujarati: {
          question: "‡™§‡™Æ‡™æ‡™∞‡´Å‡™Ç ‡™µ‡´ç‡™Ø‡™µ‡™∏‡™æ‡™Ø‡™ø‡™ï ‡™Ö‡™®‡´Å‡™≠‡™µ ‡™∏‡´ç‡™§‡™∞ ‡™∂‡´Å‡™Ç ‡™õ‡´á?",
          options: [
            { key: "none", label: "‡™ï‡´ã‡™à ‡™µ‡´ç‡™Ø‡™µ‡™∏‡™æ‡™Ø‡™ø‡™ï ‡™Ö‡™®‡´Å‡™≠‡™µ ‡™®‡™•‡´Ä", description: "‡™™‡´ç‡™∞‡™•‡™Æ ‡™µ‡™ñ‡™§ ‡™â‡™¶‡´ç‡™Ø‡´ã‡™ó‡™∏‡™æ‡™π‡™∏‡™ø‡™ï" },
            { key: "some", label: "‡™•‡´ã‡™°‡´ã ‡™µ‡´ç‡™Ø‡™µ‡™∏‡™æ‡™Ø‡™ø‡™ï ‡™Ö‡™®‡´Å‡™≠‡™µ", description: "‡™µ‡´ç‡™Ø‡™µ‡™∏‡™æ‡™Ø‡™Æ‡™æ‡™Ç 1-3 ‡™µ‡™∞‡´ç‡™∑" },
            { key: "experienced", label: "‡™Ö‡™®‡´Å‡™≠‡™µ‡´Ä", description: "3+ ‡™µ‡™∞‡´ç‡™∑ ‡™µ‡´ç‡™Ø‡™µ‡™∏‡™æ‡™Ø ‡™ö‡™≤‡™æ‡™µ‡™µ‡™æ‡™®‡´ã ‡™Ö‡™®‡´Å‡™≠‡™µ" },
            { key: "franchise", label: "‡™´‡´ç‡™∞‡´á‡™®‡´ç‡™ö‡™æ‡™á‡™ù ‡™Ö‡™®‡´Å‡™≠‡™µ", description: "‡™Ö‡™ó‡™æ‡™â ‡™´‡´ç‡™∞‡´á‡™®‡´ç‡™ö‡™æ‡™á‡™ù‡™®‡™æ ‡™Æ‡™æ‡™≤‡™ø‡™ï ‡™π‡™§‡™æ" }
          ]
        },
        Marathi: {
          question: "‡§§‡•Å‡§Æ‡§ö‡§æ ‡§µ‡•ç‡§Ø‡§æ‡§µ‡§∏‡§æ‡§Ø‡§ø‡§ï ‡§Ö‡§®‡•Å‡§≠‡§µ ‡§∏‡•ç‡§§‡§∞ ‡§ï‡§æ‡§Ø ‡§Ü‡§π‡•á?",
          options: [
            { key: "none", label: "‡§µ‡•ç‡§Ø‡§æ‡§µ‡§∏‡§æ‡§Ø‡§ø‡§ï ‡§Ö‡§®‡•Å‡§≠‡§µ ‡§®‡§æ‡§π‡•Ä", description: "‡§™‡•ç‡§∞‡§•‡§Æ ‡§µ‡•á‡§≥ ‡§â‡§¶‡•ç‡§Ø‡•ã‡§ú‡§ï" },
            { key: "some", label: "‡§ï‡§æ‡§π‡•Ä ‡§µ‡•ç‡§Ø‡§æ‡§µ‡§∏‡§æ‡§Ø‡§ø‡§ï ‡§Ö‡§®‡•Å‡§≠‡§µ", description: "‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø‡§æ‡§§ 1-3 ‡§µ‡§∞‡•ç‡§∑‡•á" },
            { key: "experienced", label: "‡§Ö‡§®‡•Å‡§≠‡§µ‡•Ä", description: "3+ ‡§µ‡§∞‡•ç‡§∑‡•á ‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø ‡§ö‡§æ‡§≤‡§µ‡§£‡•ç‡§Ø‡§æ‡§ö‡§æ ‡§Ö‡§®‡•Å‡§≠‡§µ" },
            { key: "franchise", label: "‡§´‡•ç‡§∞‡§Å‡§ö‡§æ‡§Ø‡§ù‡•Ä ‡§Ö‡§®‡•Å‡§≠‡§µ", description: "‡§™‡•Ç‡§∞‡•ç‡§µ‡•Ä ‡§´‡•ç‡§∞‡§Å‡§ö‡§æ‡§Ø‡§ù‡•Ä‡§ö‡•á ‡§Æ‡§æ‡§≤‡§ï ‡§π‡•ã‡§§‡•á" }
          ]
        },
        Tamil: {
          question: "‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æµ‡Æ£‡Æø‡Æï ‡ÆÖ‡Æ©‡ØÅ‡Æ™‡Æµ ‡Æ®‡Æø‡Æ≤‡Øà ‡Æé‡Æ©‡Øç‡Æ©?",
          options: [
            { key: "none", label: "‡Æµ‡Æ£‡Æø‡Æï ‡ÆÖ‡Æ©‡ØÅ‡Æ™‡Æµ‡ÆÆ‡Øç ‡Æá‡Æ≤‡Øç‡Æ≤‡Øà", description: "‡ÆÆ‡ØÅ‡Æ§‡Æ≤‡Øç ‡ÆÆ‡ØÅ‡Æ±‡Øà‡ÆØ‡Ææ‡Æï ‡Æ§‡Øä‡Æ¥‡Æø‡Æ≤‡Øç‡ÆÆ‡ØÅ‡Æ©‡Øà‡Æµ‡Øã‡Æ∞‡Øç" },
            { key: "some", label: "‡Æö‡Æø‡Æ≤ ‡Æµ‡Æ£‡Æø‡Æï ‡ÆÖ‡Æ©‡ØÅ‡Æ™‡Æµ‡ÆÆ‡Øç", description: "‡Æµ‡Æ£‡Æø‡Æï‡Æ§‡Øç‡Æ§‡Æø‡Æ≤‡Øç 1-3 ‡ÆÜ‡Æ£‡Øç‡Æü‡ØÅ‡Æï‡Æ≥‡Øç" },
            { key: "experienced", label: "‡ÆÖ‡Æ©‡ØÅ‡Æ™‡Æµ‡ÆÆ‡Øç ‡Æµ‡Ææ‡ÆØ‡Øç‡Æ®‡Øç‡Æ§", description: "3+ ‡ÆÜ‡Æ£‡Øç‡Æü‡ØÅ‡Æï‡Æ≥‡Øç ‡Æµ‡Æ£‡Æø‡Æï‡ÆÆ‡Øç ‡Æ®‡Æü‡Æ§‡Øç‡Æ§‡Æø‡ÆØ ‡ÆÖ‡Æ©‡ØÅ‡Æ™‡Æµ‡ÆÆ‡Øç" },
            { key: "franchise", label: "‡Æâ‡Æ∞‡Æø‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ≥‡Æ∞‡Øç ‡ÆÖ‡Æ©‡ØÅ‡Æ™‡Æµ‡ÆÆ‡Øç", description: "‡ÆÆ‡ØÅ‡Æ©‡Øç‡Æ™‡ØÅ ‡Æâ‡Æ∞‡Æø‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ≥‡Æ∞‡Øç ‡Æâ‡Æü‡Øà‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ≥‡Æ∞‡Øç" }
          ]
        },
        Telugu: {
          question: "‡∞Æ‡±Ä ‡∞µ‡±ç‡∞Ø‡∞æ‡∞™‡∞æ‡∞∞ ‡∞Ö‡∞®‡±Å‡∞≠‡∞µ ‡∞∏‡±ç‡∞•‡∞æ‡∞Ø‡∞ø ‡∞è‡∞Æ‡∞ø‡∞ü‡∞ø?",
          options: [
            { key: "none", label: "‡∞µ‡±ç‡∞Ø‡∞æ‡∞™‡∞æ‡∞∞ ‡∞Ö‡∞®‡±Å‡∞≠‡∞µ‡∞Ç ‡∞≤‡±á‡∞¶‡±Å", description: "‡∞Æ‡±ä‡∞¶‡∞ü‡∞ø‡∞∏‡∞æ‡∞∞‡∞ø ‡∞µ‡±ç‡∞Ø‡∞µ‡∞∏‡±ç‡∞•‡∞æ‡∞™‡∞ï‡±Å‡∞°‡±Å" },
            { key: "some", label: "‡∞ï‡±ä‡∞Ç‡∞§ ‡∞µ‡±ç‡∞Ø‡∞æ‡∞™‡∞æ‡∞∞ ‡∞Ö‡∞®‡±Å‡∞≠‡∞µ‡∞Ç", description: "‡∞µ‡±ç‡∞Ø‡∞æ‡∞™‡∞æ‡∞∞‡∞Ç‡∞≤‡±ã 1-3 ‡∞∏‡∞Ç‡∞µ‡∞§‡±ç‡∞∏‡∞∞‡∞æ‡∞≤‡±Å" },
            { key: "experienced", label: "‡∞Ö‡∞®‡±Å‡∞≠‡∞µ‡∞ú‡±ç‡∞û‡±Å‡∞°‡±Å", description: "3+ ‡∞∏‡∞Ç‡∞µ‡∞§‡±ç‡∞∏‡∞∞‡∞æ‡∞≤‡±Å ‡∞µ‡±ç‡∞Ø‡∞æ‡∞™‡∞æ‡∞∞‡∞Ç ‡∞®‡∞°‡∞ø‡∞™‡∞ø‡∞® ‡∞Ö‡∞®‡±Å‡∞≠‡∞µ‡∞Ç" },
            { key: "franchise", label: "‡∞´‡±ç‡∞∞‡∞æ‡∞Ç‡∞ö‡±à‡∞ú‡±Ä ‡∞Ö‡∞®‡±Å‡∞≠‡∞µ‡∞Ç", description: "‡∞ó‡∞§‡∞Ç‡∞≤‡±ã ‡∞´‡±ç‡∞∞‡∞æ‡∞Ç‡∞ö‡±à‡∞ú‡±Ä‡∞≤‡∞®‡±Å ‡∞ï‡∞≤‡∞ø‡∞ó‡∞ø ‡∞â‡∞®‡±ç‡∞®‡∞æ‡∞∞‡±Å" }
          ]
        }
      },
      3: {
        English: {
          question: "What's your risk tolerance for this investment?",
          options: [
            { key: "low", label: "Low Risk", description: "Prefer established, safe franchises" },
            { key: "moderate", label: "Moderate Risk", description: "Balanced approach to risk and returns" },
            { key: "high", label: "High Risk", description: "Willing to take risks for higher returns" }
          ]
        },
        Hindi: {
          question: "‡§á‡§∏ ‡§®‡§ø‡§µ‡•á‡§∂ ‡§ï‡•á ‡§≤‡§ø‡§è ‡§Ü‡§™‡§ï‡•Ä ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§∏‡§π‡§®‡§∂‡•Ä‡§≤‡§§‡§æ ‡§ï‡•ç‡§Ø‡§æ ‡§π‡•à?",
          options: [
            { key: "low", label: "‡§ï‡§Æ ‡§ú‡•ã‡§ñ‡§ø‡§Æ", description: "‡§∏‡•ç‡§•‡§æ‡§™‡§ø‡§§, ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§´‡•ç‡§∞‡•à‡§Ç‡§ö‡§æ‡§á‡§ú‡§º‡•Ä ‡§™‡§∏‡§Ç‡§¶ ‡§ï‡§∞‡§§‡•á ‡§π‡•à‡§Ç" },
            { key: "moderate", label: "‡§Æ‡§ß‡•ç‡§Ø‡§Æ ‡§ú‡•ã‡§ñ‡§ø‡§Æ", description: "‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§î‡§∞ ‡§∞‡§ø‡§ü‡§∞‡•ç‡§® ‡§ï‡§æ ‡§∏‡§Ç‡§§‡•Å‡§≤‡§ø‡§§ ‡§¶‡•É‡§∑‡•ç‡§ü‡§ø‡§ï‡•ã‡§£" },
            { key: "high", label: "‡§â‡§ö‡•ç‡§ö ‡§ú‡•ã‡§ñ‡§ø‡§Æ", description: "‡§Ö‡§ß‡§ø‡§ï ‡§∞‡§ø‡§ü‡§∞‡•ç‡§® ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ú‡•ã‡§ñ‡§ø‡§Æ ‡§≤‡•á‡§®‡•á ‡§ï‡•ã ‡§§‡•à‡§Ø‡§æ‡§∞" }
          ]
        },
        Gujarati: {
          question: "‡™Ü ‡™∞‡´ã‡™ï‡™æ‡™£ ‡™Æ‡™æ‡™ü‡´á ‡™§‡™Æ‡™æ‡™∞‡´Ä ‡™ú‡´ã‡™ñ‡™Æ ‡™∏‡™π‡™®‡™∂‡´Ä‡™≤‡™§‡™æ ‡™∂‡´Å‡™Ç ‡™õ‡´á?",
          options: [
            { key: "low", label: "‡™ì‡™õ‡´Å‡™Ç ‡™ú‡´ã‡™ñ‡™Æ", description: "‡™∏‡´ç‡™•‡™æ‡™™‡™ø‡™§, ‡™∏‡´Å‡™∞‡™ï‡´ç‡™∑‡™ø‡™§ ‡™´‡´ç‡™∞‡´á‡™®‡´ç‡™ö‡™æ‡™á‡™ù ‡™™‡™∏‡™Ç‡™¶ ‡™ï‡™∞‡´ã ‡™õ‡´ã" },
            { key: "moderate", label: "‡™Æ‡™ß‡´ç‡™Ø‡™Æ ‡™ú‡´ã‡™ñ‡™Æ", description: "‡™ú‡´ã‡™ñ‡™Æ ‡™Ö‡™®‡´á ‡™µ‡™≥‡™§‡™∞‡™®‡´ã ‡™∏‡™Ç‡™§‡´Å‡™≤‡™ø‡™§ ‡™Ö‡™≠‡™ø‡™ó‡™Æ" },
            { key: "high", label: "‡™â‡™ö‡´ç‡™ö ‡™ú‡´ã‡™ñ‡™Æ", description: "‡™µ‡™ß‡´Å ‡™µ‡™≥‡™§‡™∞ ‡™Æ‡™æ‡™ü‡´á ‡™ú‡´ã‡™ñ‡™Æ ‡™≤‡´á‡™µ‡™æ ‡™§‡´à‡™Ø‡™æ‡™∞" }
          ]
        },
        Marathi: {
          question: "‡§Ø‡§æ ‡§ó‡•Å‡§Ç‡§§‡§µ‡§£‡•Å‡§ï‡•Ä‡§∏‡§æ‡§†‡•Ä ‡§§‡•Å‡§Æ‡§ö‡•Ä ‡§ú‡•ã‡§ñ‡•Ä‡§Æ ‡§∏‡§π‡§®‡§∂‡•Ä‡§≤‡§§‡§æ ‡§ï‡§æ‡§Ø ‡§Ü‡§π‡•á?",
          options: [
            { key: "low", label: "‡§ï‡§Æ‡•Ä ‡§ú‡•ã‡§ñ‡•Ä‡§Æ", description: "‡§™‡•ç‡§∞‡§∏‡•ç‡§•‡§æ‡§™‡§ø‡§§, ‡§∏‡•Å‡§∞‡§ï‡•ç‡§∑‡§ø‡§§ ‡§´‡•ç‡§∞‡§Å‡§ö‡§æ‡§Ø‡§ù‡•Ä ‡§™‡§∏‡§Ç‡§¶ ‡§ï‡§∞‡§§‡§æ‡§§" },
            { key: "moderate", label: "‡§Æ‡§ß‡•ç‡§Ø‡§Æ ‡§ú‡•ã‡§ñ‡•Ä‡§Æ", description: "‡§ú‡•ã‡§ñ‡•Ä‡§Æ ‡§Ü‡§£‡§ø ‡§™‡§∞‡§§‡§æ‡§µ‡•ç‡§Ø‡§æ‡§ö‡§æ ‡§∏‡§Ç‡§§‡•Å‡§≤‡§ø‡§§ ‡§¶‡•É‡§∑‡•ç‡§ü‡§ø‡§ï‡•ã‡§®" },
            { key: "high", label: "‡§â‡§ö‡•ç‡§ö ‡§ú‡•ã‡§ñ‡•Ä‡§Æ", description: "‡§ú‡§æ‡§∏‡•ç‡§§ ‡§™‡§∞‡§§‡§æ‡§µ‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä ‡§ú‡•ã‡§ñ‡•Ä‡§Æ ‡§ò‡•á‡§£‡•ç‡§Ø‡§æ‡§∏ ‡§§‡§Ø‡§æ‡§∞" }
          ]
        },
        Tamil: {
          question: "‡Æá‡Æ®‡Øç‡Æ§ ‡ÆÆ‡ØÅ‡Æ§‡Æ≤‡ØÄ‡Æü‡Øç‡Æü‡Æø‡Æ±‡Øç‡Æï‡Ææ‡Æ© ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ∞‡Æø‡Æ∏‡Øç‡Æï‡Øç ‡Æü‡Ææ‡Æ≤‡Æ∞‡Æ©‡Øç‡Æ∏‡Øç ‡Æé‡Æ©‡Øç‡Æ©?",
          options: [
            { key: "low", label: "‡Æï‡ØÅ‡Æ±‡Øà‡Æ®‡Øç‡Æ§ ‡Æ∞‡Æø‡Æ∏‡Øç‡Æï‡Øç", description: "‡Æ®‡Æø‡Æ±‡ØÅ‡Æµ‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü, ‡Æ™‡Ææ‡Æ§‡ØÅ‡Æï‡Ææ‡Æ™‡Øç‡Æ™‡Ææ‡Æ© ‡Æâ‡Æ∞‡Æø‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ≥‡Æ∞‡Øç‡Æï‡Æ≥‡Øà ‡Æµ‡Æø‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡ØÅ‡Æï‡Æø‡Æ±‡Øá‡Æ©‡Øç" },
            { key: "moderate", label: "‡ÆÆ‡Æø‡Æ§‡ÆÆ‡Ææ‡Æ© ‡Æ∞‡Æø‡Æ∏‡Øç‡Æï‡Øç", description: "‡Æ∞‡Æø‡Æ∏‡Øç‡Æï‡Øç ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡Æµ‡Æ∞‡ØÅ‡ÆÆ‡Ææ‡Æ©‡Æ§‡Øç‡Æ§‡Æø‡Æ©‡Øç ‡Æö‡ÆÆ‡Æ®‡Æø‡Æ≤‡Øà ‡ÆÖ‡Æ£‡ØÅ‡Æï‡ØÅ‡ÆÆ‡ØÅ‡Æ±‡Øà" },
            { key: "high", label: "‡ÆÖ‡Æ§‡Æø‡Æï ‡Æ∞‡Æø‡Æ∏‡Øç‡Æï‡Øç", description: "‡ÆÖ‡Æ§‡Æø‡Æï ‡Æµ‡Æ∞‡ØÅ‡ÆÆ‡Ææ‡Æ©‡Æ§‡Øç‡Æ§‡Æø‡Æ±‡Øç‡Æï‡Ææ‡Æï ‡Æ∞‡Æø‡Æ∏‡Øç‡Æï‡Øç ‡Æé‡Æü‡ØÅ‡Æï‡Øç‡Æï ‡Æ§‡ÆØ‡Ææ‡Æ∞‡Ææ‡Æï ‡Æâ‡Æ≥‡Øç‡Æ≥‡Øá‡Æ©‡Øç" }
          ]
        },
        Telugu: {
          question: "‡∞à ‡∞™‡±Ü‡∞ü‡±ç‡∞ü‡±Å‡∞¨‡∞°‡∞ø‡∞ï‡∞ø ‡∞Æ‡±Ä ‡∞∞‡∞ø‡∞∏‡±ç‡∞ï‡±ç ‡∞ü‡∞æ‡∞≤‡∞∞‡±Ü‡∞®‡±ç‡∞∏‡±ç ‡∞è‡∞Æ‡∞ø‡∞ü‡∞ø?",
          options: [
            { key: "low", label: "‡∞§‡∞ï‡±ç‡∞ï‡±Å‡∞µ ‡∞∞‡∞ø‡∞∏‡±ç‡∞ï‡±ç", description: "‡∞∏‡±ç‡∞•‡∞æ‡∞™‡∞ø‡∞§‡∞Æ‡±à‡∞®, ‡∞∏‡±Å‡∞∞‡∞ï‡±ç‡∞∑‡∞ø‡∞§‡∞Æ‡±à‡∞® ‡∞´‡±ç‡∞∞‡∞æ‡∞Ç‡∞ö‡±à‡∞ú‡±Ä‡∞≤‡∞®‡±Å ‡∞á‡∞∑‡±ç‡∞ü‡∞™‡∞°‡∞§‡∞æ‡∞∞‡±Å" },
            { key: "moderate", label: "‡∞Æ‡∞ø‡∞§‡∞Æ‡±à‡∞® ‡∞∞‡∞ø‡∞∏‡±ç‡∞ï‡±ç", description: "‡∞∞‡∞ø‡∞∏‡±ç‡∞ï‡±ç ‡∞Æ‡∞∞‡∞ø‡∞Ø‡±Å ‡∞∞‡∞ø‡∞ü‡∞∞‡±ç‡∞®‡±ç‚Äå‡∞≤ ‡∞∏‡∞Æ‡∞§‡±Å‡∞≤‡±ç‡∞Ø ‡∞µ‡∞ø‡∞ß‡∞æ‡∞®‡∞Ç" },
            { key: "high", label: "‡∞Ö‡∞ß‡∞ø‡∞ï ‡∞∞‡∞ø‡∞∏‡±ç‡∞ï‡±ç", description: "‡∞é‡∞ï‡±ç‡∞ï‡±Å‡∞µ ‡∞∞‡∞ø‡∞ü‡∞∞‡±ç‡∞®‡±ç‚Äå‡∞≤ ‡∞ï‡±ã‡∞∏‡∞Ç ‡∞∞‡∞ø‡∞∏‡±ç‡∞ï‡±ç ‡∞§‡±Ä‡∞∏‡±Å‡∞ï‡±ã‡∞µ‡∞°‡∞æ‡∞®‡∞ø‡∞ï‡∞ø ‡∞∏‡∞ø‡∞¶‡±ç‡∞ß‡∞Ç‡∞ó‡∞æ ‡∞â‡∞®‡±ç‡∞®‡∞æ‡∞∞‡±Å" }
          ]
        }
      },
      4: {
        English: {
          question: "When are you looking to start your franchise?",
          options: [
            { key: "asap", label: "As soon as possible", description: "Ready to start immediately" },
            { key: "3months", label: "Within 3 months", description: "Planning to start in 3 months" },
            { key: "6months", label: "Within 6 months", description: "Planning to start in 6 months" },
            { key: "exploring", label: "Just exploring", description: "Still researching options" }
          ]
        },
        Hindi: {
          question: "‡§Ü‡§™ ‡§Ö‡§™‡§®‡•Ä ‡§´‡•ç‡§∞‡•à‡§Ç‡§ö‡§æ‡§á‡§ú‡§º‡•Ä ‡§ï‡§¨ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§®‡§æ ‡§ö‡§æ‡§π‡§§‡•á ‡§π‡•à‡§Ç?",
          options: [
            { key: "asap", label: "‡§ú‡§≤‡•ç‡§¶ ‡§∏‡•á ‡§ú‡§≤‡•ç‡§¶", description: "‡§§‡•Å‡§∞‡§Ç‡§§ ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§§‡•à‡§Ø‡§æ‡§∞" },
            { key: "3months", label: "3 ‡§Æ‡§π‡•Ä‡§®‡•á ‡§ï‡•á ‡§≠‡•Ä‡§§‡§∞", description: "3 ‡§Æ‡§π‡•Ä‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ø‡•ã‡§ú‡§®‡§æ" },
            { key: "6months", label: "6 ‡§Æ‡§π‡•Ä‡§®‡•á ‡§ï‡•á ‡§≠‡•Ä‡§§‡§∞", description: "6 ‡§Æ‡§π‡•Ä‡§®‡•á ‡§Æ‡•á‡§Ç ‡§∂‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§®‡•á ‡§ï‡•Ä ‡§Ø‡•ã‡§ú‡§®‡§æ" },
            { key: "exploring", label: "‡§∏‡§ø‡§∞‡•ç‡§´ ‡§ñ‡•ã‡§ú ‡§∞‡§π‡§æ ‡§π‡•Ç‡§Ç", description: "‡§Ö‡§≠‡•Ä ‡§≠‡•Ä ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™‡•ã‡§Ç ‡§™‡§∞ ‡§∂‡•ã‡§ß ‡§ï‡§∞ ‡§∞‡§π‡§æ ‡§π‡•Ç‡§Ç" }
          ]
        },
        Gujarati: {
          question: "‡™§‡™Æ‡´á ‡™§‡™Æ‡™æ‡™∞‡´Ä ‡™´‡´ç‡™∞‡´á‡™®‡´ç‡™ö‡™æ‡™á‡™ù ‡™ï‡´ç‡™Ø‡™æ‡™∞‡´á ‡™∂‡™∞‡´Ç ‡™ï‡™∞‡™µ‡™æ ‡™Æ‡™æ‡™Ç‡™ó‡´ã ‡™õ‡´ã?",
          options: [
            { key: "asap", label: "‡™∂‡™ï‡´ç‡™Ø ‡™§‡´á‡™ü‡™≤‡´Ä ‡™ú‡™≤‡´ç‡™¶‡´Ä", description: "‡™§‡™∞‡™§ ‡™ú ‡™∂‡™∞‡´Ç ‡™ï‡™∞‡™µ‡™æ ‡™Æ‡™æ‡™ü‡´á ‡™§‡´à‡™Ø‡™æ‡™∞" },
            { key: "3months", label: "3 ‡™Æ‡™π‡™ø‡™®‡™æ‡™Æ‡™æ‡™Ç", description: "3 ‡™Æ‡™π‡™ø‡™®‡™æ‡™Æ‡™æ‡™Ç ‡™∂‡™∞‡´Ç ‡™ï‡™∞‡™µ‡™æ‡™®‡´Ä ‡™Ø‡´ã‡™ú‡™®‡™æ" },
            { key: "6months", label: "6 ‡™Æ‡™π‡™ø‡™®‡™æ‡™Æ‡™æ‡™Ç", description: "6 ‡™Æ‡™π‡™ø‡™®‡™æ‡™Æ‡™æ‡™Ç ‡™∂‡™∞‡´Ç ‡™ï‡™∞‡™µ‡™æ‡™®‡´Ä ‡™Ø‡´ã‡™ú‡™®‡™æ" },
            { key: "exploring", label: "‡™´‡™ï‡´ç‡™§ ‡™∂‡´ã‡™ß ‡™∞‡™π‡´ç‡™Ø‡™æ ‡™õ‡´Ä‡™è", description: "‡™π‡™ú‡´Å ‡™™‡™£ ‡™µ‡™ø‡™ï‡™≤‡´ç‡™™‡´ã‡™®‡´Å‡™Ç ‡™∏‡™Ç‡™∂‡´ã‡™ß‡™® ‡™ï‡™∞‡´Ä ‡™∞‡™π‡´ç‡™Ø‡™æ ‡™õ‡´Ä‡™è" }
          ]
        },
        Marathi: {
          question: "‡§§‡•Å‡§Æ‡•ç‡§π‡•Ä ‡§§‡•Å‡§Æ‡§ö‡•á ‡§´‡•ç‡§∞‡§Å‡§ö‡§æ‡§Ø‡§ù‡•Ä ‡§ï‡§ß‡•Ä ‡§∏‡•Å‡§∞‡•Ç ‡§ï‡§∞‡•Ç ‡§á‡§ö‡•ç‡§õ‡§ø‡§§‡§æ?",
          options: [
            { key: "asap", label: "‡§∂‡§ï‡•ç‡§Ø ‡§§‡§ø‡§§‡§ï‡•ç‡§Ø‡§æ ‡§≤‡§µ‡§ï‡§∞", description: "‡§≤‡§ó‡•á‡§ö ‡§∏‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§£‡•ç‡§Ø‡§æ‡§∏‡§æ‡§†‡•Ä ‡§§‡§Ø‡§æ‡§∞" },
            { key: "3months", label: "3 ‡§Æ‡§π‡§ø‡§®‡•ç‡§Ø‡§æ‡§Ç‡§§", description: "3 ‡§Æ‡§π‡§ø‡§®‡•ç‡§Ø‡§æ‡§Ç‡§§ ‡§∏‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§£‡•ç‡§Ø‡§æ‡§ö‡•Ä ‡§Ø‡•ã‡§ú‡§®‡§æ" },
            { key: "6months", label: "6 ‡§Æ‡§π‡§ø‡§®‡•ç‡§Ø‡§æ‡§Ç‡§§", description: "6 ‡§Æ‡§π‡§ø‡§®‡•ç‡§Ø‡§æ‡§Ç‡§§ ‡§∏‡•Å‡§∞‡•Ç ‡§ï‡§∞‡§£‡•ç‡§Ø‡§æ‡§ö‡•Ä ‡§Ø‡•ã‡§ú‡§®‡§æ" },
            { key: "exploring", label: "‡§´‡§ï‡•ç‡§§ ‡§∂‡•ã‡§ß‡§§ ‡§Ü‡§π‡•á", description: "‡§Ö‡§ú‡•Ç‡§®‡§π‡•Ä ‡§™‡§∞‡•ç‡§Ø‡§æ‡§Ø‡§æ‡§Ç‡§µ‡§∞ ‡§∏‡§Ç‡§∂‡•ã‡§ß‡§® ‡§ï‡§∞‡§§ ‡§Ü‡§π‡•á" }
          ]
        },
        Tamil: {
          question: "‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æâ‡Æ∞‡Æø‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ≥‡Æ∞‡Øç ‡Æé‡Æ™‡Øç‡Æ™‡Øã‡Æ§‡ØÅ ‡Æ§‡Øä‡Æü‡Æô‡Øç‡Æï ‡Æµ‡Æø‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡ØÅ‡Æï‡Æø‡Æ±‡ØÄ‡Æ∞‡Øç‡Æï‡Æ≥‡Øç?",
          options: [
            { key: "asap", label: "‡ÆÆ‡ØÅ‡Æü‡Æø‡Æ®‡Øç‡Æ§‡Æµ‡Æ∞‡Øà ‡Æµ‡Æø‡Æ∞‡Øà‡Æµ‡Æø‡Æ≤‡Øç", description: "‡Æâ‡Æü‡Æ©‡Æü‡Æø‡ÆØ‡Ææ‡Æï ‡Æ§‡Øä‡Æü‡Æô‡Øç‡Æï ‡Æ§‡ÆØ‡Ææ‡Æ∞‡Ææ‡Æï ‡Æâ‡Æ≥‡Øç‡Æ≥‡Øá‡Æ©‡Øç" },
            { key: "3months", label: "3 ‡ÆÆ‡Ææ‡Æ§‡Æô‡Øç‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ‡Æ≥‡Øç", description: "3 ‡ÆÆ‡Ææ‡Æ§‡Æô‡Øç‡Æï‡Æ≥‡Æø‡Æ≤‡Øç ‡Æ§‡Øä‡Æü‡Æô‡Øç‡Æï ‡Æ§‡Æø‡Æü‡Øç‡Æü‡ÆÆ‡Æø‡Æü‡Øç‡Æü‡ØÅ‡Æ≥‡Øç‡Æ≥‡Øá‡Æ©‡Øç" },
            { key: "6months", label: "6 ‡ÆÆ‡Ææ‡Æ§‡Æô‡Øç‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ‡Æ≥‡Øç", description: "6 ‡ÆÆ‡Ææ‡Æ§‡Æô‡Øç‡Æï‡Æ≥‡Æø‡Æ≤‡Øç ‡Æ§‡Øä‡Æü‡Æô‡Øç‡Æï ‡Æ§‡Æø‡Æü‡Øç‡Æü‡ÆÆ‡Æø‡Æü‡Øç‡Æü‡ØÅ‡Æ≥‡Øç‡Æ≥‡Øá‡Æ©‡Øç" },
            { key: "exploring", label: "‡Æµ‡ØÜ‡Æ±‡ØÅ‡ÆÆ‡Øç ‡ÆÜ‡Æ∞‡Ææ‡ÆØ‡Øç‡Æö‡Øç‡Æö‡Æø", description: "‡Æá‡Æ©‡Øç‡Æ©‡ØÅ‡ÆÆ‡Øç ‡Æµ‡Æø‡Æ∞‡ØÅ‡Æ™‡Øç‡Æ™‡Æô‡Øç‡Æï‡Æ≥‡Øà ‡ÆÜ‡Æ∞‡Ææ‡ÆØ‡Øç‡Æ®‡Øç‡Æ§‡ØÅ ‡Æµ‡Æ∞‡ØÅ‡Æï‡Æø‡Æ±‡Øá‡Æ©‡Øç" }
          ]
        },
        Telugu: {
          question: "‡∞Æ‡±Ä‡∞∞‡±Å ‡∞Æ‡±Ä ‡∞´‡±ç‡∞∞‡∞æ‡∞Ç‡∞ö‡±à‡∞ú‡±Ä‡∞®‡∞ø ‡Æé‡∞™‡±ç‡∞™‡±Å‡∞°‡±Å ‡∞™‡±ç‡∞∞‡∞æ‡∞∞‡∞Ç‡∞≠‡∞ø‡∞Ç‡∞ö‡∞æ‡∞≤‡∞®‡±Å‡∞ï‡±Å‡∞Ç‡∞ü‡±Å‡∞®‡±ç‡∞®‡∞æ‡∞∞‡±Å?",
          options: [
            { key: "asap", label: "‡∞µ‡±Ä‡∞≤‡±à‡∞®‡∞Ç‡∞§ ‡∞§‡±ç‡∞µ‡∞∞‡∞ó‡∞æ", description: "‡∞µ‡±Ü‡∞Ç‡∞ü‡∞®‡±á ‡∞™‡±ç‡∞∞‡∞æ‡∞∞‡∞Ç‡∞≠‡∞ø‡∞Ç‡∞ö‡∞°‡∞æ‡∞®‡∞ø‡∞ï‡∞ø ‡∞∏‡∞ø‡∞¶‡±ç‡∞ß‡∞Ç‡∞ó‡∞æ ‡∞â‡∞®‡±ç‡∞®‡∞æ‡∞∞‡±Å" },
            { key: "3months", label: "3 ‡∞®‡±Ü‡∞≤‡∞≤‡±ç‡∞≤‡±ã", description: "3 ‡∞®‡±Ü‡∞≤‡∞≤‡±ç‡∞≤‡±ã ‡∞™‡±ç‡∞∞‡∞æ‡∞∞‡∞Ç‡∞≠‡∞ø‡∞Ç‡∞ö‡±á ‡∞™‡±ç‡∞≤‡∞æ‡∞®‡±ç" },
            { key: "6months", label: "6 ‡∞®‡±Ü‡∞≤‡∞≤‡±ç‡∞≤‡±ã", description: "6 ‡∞®‡±Ü‡∞≤‡∞≤‡±ç‡∞≤‡±ã ‡∞™‡±ç‡∞∞‡∞æ‡∞∞‡∞Ç‡∞≠‡∞ø‡∞Ç‡∞ö‡±á ‡∞™‡±ç‡∞≤‡∞æ‡∞®‡±ç" },
            { key: "exploring", label: "‡∞ï‡±á‡∞µ‡∞≤‡∞Ç ‡∞Ö‡∞®‡±ç‡∞µ‡±á‡∞∑‡∞ø‡∞∏‡±ç‡∞§‡±Å‡∞®‡±ç‡∞®‡∞æ‡∞®‡±Å", description: "‡∞á‡∞Ç‡∞ï‡∞æ ‡∞é‡∞Ç‡∞™‡∞ø‡∞ï‡∞≤‡∞®‡±Å ‡∞™‡∞∞‡∞ø‡∞∂‡±ã‡∞ß‡∞ø‡∞∏‡±ç‡∞§‡±Å‡∞®‡±ç‡∞®‡∞æ‡∞®‡±Å" }
          ]
        }
      }
    };

    return questions[step]?.[language] || questions[step]?.["English"];
  };

  const handleStartChat = (info) => {
    setUserInfo(info);
    const questionData = getQuestionData(1, info.language);
    const greeting = getGreeting(info.name, info.budget, info.language);
    
    setMessages([
      {
        id: 1,
        sender: "bot",
        timestamp: new Date(),
        text: `${greeting}\n\n${questionData.question}`,
        options: questionData.options
      },
    ]);
    setChatPhase("chatting");
    setCurrentQuestionStep(1);
  };

  const handleOptionSelect = async (option) => {
    const userMessage = {
      id: messages.length + 1,
      text: `${option.label} - ${option.description}`,
      sender: "user",
      timestamp: new Date(),
    };

    setMessages((prev) => [...prev, userMessage]);
    setIsLoading(true);

    // Store the response
    const responseKey = {
      1: 'industry',
      2: 'experience', 
      3: 'riskTolerance',
      4: 'timeline'
    }[currentQuestionStep];

    const newResponses = {
      ...userResponses,
      [responseKey]: option.label
    };
    setUserResponses(newResponses);

    try {
      if (currentQuestionStep < 4) {
        // Move to next question
        const nextStep = currentQuestionStep + 1;
        const questionData = getQuestionData(nextStep, userInfo.language);
        
        setTimeout(() => {
          setMessages((prev) => [
            ...prev,
            {
              id: prev.length + 1,
              text: questionData.question,
              sender: "bot",
              timestamp: new Date(),
              options: questionData.options
            },
          ]);
          setCurrentQuestionStep(nextStep);
          setIsLoading(false);
        }, 1000);
      } else {
        // Save chat lead first
        await saveChatLead(newResponses, userInfo);
        
        setTimeout(async () => {
          const matches = await findMatchingBrands(newResponses, userInfo);
          setMatchedBrands(matches);
          
          if (matches.length > 0) {
            const recommendationMsg = getRecommendationMessage(matches.length, userInfo.language);
            setMessages((prev) => [
              ...prev,
              {
                id: prev.length + 1,
                text: recommendationMsg,
                sender: "bot",
                timestamp: new Date(),
                recommendations: matches
              },
            ]);
          } else {
            const noMatchMsg = getNoMatchMessage(userInfo.language);
            setMessages((prev) => [
              ...prev,
              {
                id: prev.length + 1,
                text: noMatchMsg,
                sender: "bot",
                timestamp: new Date(),
                showBrowseButton: true
              },
            ]);
          }
          setChatPhase("recommendations");
          setIsLoading(false);
        }, 1500);
      }
    } catch (error) {
      logger.error("Error processing response:", error);
      setIsLoading(false);
    }
  };

  const handleBrandClick = (brand) => {
    // Generate consistent URL-friendly slug
    const slug = generateBrandSlug(brand.brandName);
    
    // Open brand page in new window/tab instead of navigating away
    const brandUrl = `${window.location.origin}/brands/${slug || brand.id}`;
    window.open(brandUrl, '_blank', 'noopener,noreferrer');
    
    // Don't close the chat - keep it open so user can see chat content
    // setOpen(false); // Removed this line
  };

  const handleClose = () => {
    setOpen(false);
  };

  const formatInvestmentAmount = (amount) => {
    if (!amount) return "Contact for details";
    const numAmount = parseInt(amount.toString().replace(/[‚Çπ,]/g, ''));
    if (numAmount >= 100000) {
      return `‚Çπ${(numAmount / 100000).toFixed(1)}L`;
    } else if (numAmount >= 1000) {
      return `‚Çπ${(numAmount / 1000).toFixed(0)}K`;
    }
    return `‚Çπ${numAmount}`;
  };

  return (
    <>
      <Fab
        color="primary"
        sx={{
          position: "fixed",
          bottom: 24,
          right: 24,
          zIndex: 1300,
          width: 64,
          height: 64,
        }}
        onClick={() => setOpen(true)}
      >
        <Badge badgeContent="New" color="secondary" variant="dot">
          <ChatIcon />
        </Badge>
      </Fab>

      <Dialog
        open={open}
        onClose={handleClose}
        maxWidth="sm"
        fullWidth
        PaperProps={{
          sx: {
            height: "80vh",
            maxHeight: 700,
            position: "fixed",
            bottom: { xs: 0, sm: 100 },
            right: { xs: 0, sm: 24 },
            m: 0,
            maxWidth: 420,
            borderRadius: { xs: 0, sm: 4 },
            width: "100%",
          },
        }}
      >
        <DialogTitle
          sx={{
            display: "flex",
            alignItems: "center",
            justifyContent: "space-between",
            pb: 1,
            background: "linear-gradient(135deg, #1976d2 0%, #42a5f5 100%)",
            color: "white"
          }}
        >
          <Box sx={{ display: "flex", alignItems: "center" }}>
            <Avatar sx={{ mr: 2, backgroundColor: "rgba(255,255,255,0.2)" }}>
              <Support />
            </Avatar>
            <Box>
              <Typography variant="h6" fontWeight="bold">
                FranchiseHub Assistant
              </Typography>
              <Typography variant="caption" sx={{ opacity: 0.9, display: "flex", alignItems: "center", gap: 0.5 }}>
                Find your perfect franchise match
                {chatPhase === "recommendations" && (
                  <>
                    <Launch fontSize="inherit" sx={{ ml: 1 }} />
                    Links open in new tabs
                  </>
                )}
              </Typography>
            </Box>
          </Box>
          <IconButton onClick={handleClose} sx={{ color: "white" }} aria-label="Close chatbot">
            <Close />
          </IconButton>
        </DialogTitle>

        <Divider />

        <DialogContent
          sx={{
            p: 0,
            display: "flex",
            flexDirection: "column",
            height: "100%",
          }}
        >
          {chatPhase === "pre-chat" ? (
            <UserInfoForm onStartChat={handleStartChat} />
          ) : (
            <>
              <Box sx={{ flexGrow: 1, p: 2, overflowY: "auto" }}>
                {messages.map((message) => (
                  <Box key={message.id}>
                    <Box
                      sx={{
                        display: "flex",
                        justifyContent:
                          message.sender === "user" ? "flex-end" : "flex-start",
                        mb: 2,
                      }}
                    >
                      <Paper
                        sx={{
                          p: 2,
                          maxWidth: "85%",
                          backgroundColor:
                            message.sender === "user"
                              ? "primary.main"
                              : "grey.100",
                          color:
                            message.sender === "user"
                              ? "white"
                              : "text.primary",
                          borderRadius:
                            message.sender === "user"
                              ? "20px 20px 4px 20px"
                              : "20px 20px 20px 4px",
                        }}
                      >
                        <Typography variant="body1" sx={{ whiteSpace: 'pre-line' }}>
                          {message.text}
                        </Typography>
                      </Paper>
                    </Box>

                    {/* Options for bot messages - Using Chips */}
                    {message.sender === "bot" && message.options && (
                      <Box sx={{ mb: 2, px: 1 }}>
                        <Typography 
                          variant="caption" 
                          color="text.secondary" 
                          sx={{ mb: 1, display: "block" }}
                        >
                          {userInfo?.language === "Hindi" 
                            ? "‡§è‡§ï ‡§µ‡§ø‡§ï‡§≤‡•ç‡§™ ‡§ö‡•Å‡§®‡•á‡§Ç:"
                            : "Choose an option:"}
                        </Typography>
                        <Box sx={{ display: "flex", flexWrap: "wrap", gap: 1, justifyContent: "flex-start" }}>
                          {message.options.map((option) => (
                            <Chip
                              key={option.key}
                              label={option.label}
                              onClick={() => handleOptionSelect(option)}
                              color="primary"
                              variant="outlined"
                              sx={{
                                cursor: "pointer",
                                mb: 1,
                                transition: "all 0.3s ease",
                                borderRadius: "20px",
                                border: "2px solid",
                                borderColor: "primary.main",
                                backgroundColor: "transparent",
                                color: "primary.main",
                                "&:hover": {
                                  backgroundColor: "primary.main",
                                  color: "white",
                                  transform: "translateY(-2px)",
                                  boxShadow: "0 4px 12px rgba(25, 118, 210, 0.3)",
                                  "& .MuiChip-label": {
                                    color: "white",
                                  }
                                },
                                "&:active": {
                                  transform: "translateY(0px)",
                                },
                                fontSize: "0.875rem",
                                height: "40px",
                                "& .MuiChip-label": {
                                  padding: "0 16px",
                                  fontWeight: "500",
                                  color: "inherit"
                                }
                              }}
                              title={option.description} // Tooltip for description
                            />
                          ))}
                        </Box>
                        
                        {/* Helper text showing that descriptions are available on hover */}
                        <Typography 
                          variant="caption" 
                          color="text.disabled" 
                          sx={{ mt: 1, display: "block", fontStyle: "italic" }}
                        >
                          üí° Hover over options to see details
                        </Typography>
                      </Box>
                    )}

                    {/* Brand Recommendations */}
                    {message.sender === "bot" && message.recommendations && (
                      <Box sx={{ mb: 2 }}>
                        <Stack spacing={2}>
                          {message.recommendations.map((brand, index) => (
                            <Card 
                              key={brand.id}
                              sx={{ 
                                cursor: "pointer",
                                transition: "all 0.3s",
                                "&:hover": { 
                                  transform: "translateY(-3px)",
                                  boxShadow: 6 
                                },
                                border: index === 0 ? "2px solid #1976d2" : "1px solid #e0e0e0"
                              }}
                              onClick={() => handleBrandClick(brand)}
                            >
                              {index === 0 && (
                                <Box sx={{ 
                                  background: "linear-gradient(135deg, #1976d2, #42a5f5)",
                                  color: "white",
                                  px: 2,
                                  py: 0.5,
                                  display: "flex",
                                  alignItems: "center",
                                  justifyContent: "center",
                                  gap: 1
                                }}>
                                  <Star fontSize="small" />
                                  <Typography variant="caption" fontWeight="bold">
                                    BEST MATCH
                                  </Typography>
                                </Box>
                              )}
                              <CardContent>
                                <Box sx={{ display: "flex", justifyContent: "space-between", alignItems: "flex-start", mb: 1 }}>
                                  <Typography variant="h6" fontWeight="bold">
                                    {brand.brandName}
                                  </Typography>
                                  <Chip 
                                    label={`${brand.matchScore}% Match`} 
                                    color="success" 
                                    size="small"
                                    icon={<CheckCircle />}
                                  />
                                </Box>
                                
                                <Box sx={{ display: "flex", flexWrap: "wrap", gap: 1, mb: 2 }}>
                                  {brand.industries?.slice(0, 2).map((industry) => (
                                    <Chip key={industry} label={industry} size="small" color="primary" variant="outlined" />
                                  ))}
                                </Box>

                                <Grid container spacing={1} sx={{ mb: 2 }}>
                                  <Grid item xs={6}>
                                    <Box sx={{ display: "flex", alignItems: "center", gap: 1 }}>
                                      <AttachMoney fontSize="small" color="primary" />
                                      <Box>
                                        <Typography variant="caption" color="text.secondary">Investment</Typography>
                                        <Typography variant="body2" fontWeight="bold">
                                          {brand.investmentRange}
                                        </Typography>
                                      </Box>
                                    </Box>
                                  </Grid>
                                  <Grid item xs={6}>
                                    <Box sx={{ display: "flex", alignItems: "center", gap: 1 }}>
                                      <TrendingUp fontSize="small" color="primary" />
                                      <Box>
                                        <Typography variant="caption" color="text.secondary">Royalty</Typography>
                                        <Typography variant="body2" fontWeight="bold">
                                          {brand.royaltyFee}%
                                        </Typography>
                                      </Box>
                                    </Box>
                                  </Grid>
                                </Grid>

                                <Typography variant="body2" color="text.secondary" sx={{ mb: 2 }}>
                                  {brand.brandMission?.substring(0, 100)}...
                                </Typography>

                                <Box sx={{ mb: 2 }}>
                                  <Typography variant="caption" color="text.secondary" fontWeight="bold">
                                    Why it's perfect for you:
                                  </Typography>
                                  {brand.matchReasons?.slice(0, 2).map((reason, idx) => (
                                    <Typography key={idx} variant="caption" display="block" color="success.main">
                                      ‚úì {reason}
                                    </Typography>
                                  ))}
                                </Box>
                              </CardContent>
                              <CardActions sx={{ justifyContent: "space-between", px: 2, pb: 2 }}>
                                <Button 
                                  variant="contained" 
                                  color="primary" 
                                  size="small"
                                  endIcon={<Launch />}
                                  onClick={(e) => {
                                    e.stopPropagation();
                                    handleBrandClick(brand);
                                  }}
                                >
                                  {getButtonText('viewDetails', userInfo?.language)}
                                </Button>
                                <Typography variant="caption" color="text.secondary" sx={{ display: "flex", alignItems: "center", gap: 0.5 }}>
                                  <Launch fontSize="inherit" />
                                  {getButtonText('opensInNewTab', userInfo?.language)}
                                </Typography>
                              </CardActions>
                            </Card>
                          ))}
                        </Stack>
                      </Box>
                    )}

                    {/* Browse All Button */}
                    {message.sender === "bot" && message.showBrowseButton && (
                      <Box sx={{ mb: 2, textAlign: "center" }}>
                        <Button 
                          variant="contained" 
                          color="primary"
                          onClick={() => {
                            const brandsUrl = `${window.location.origin}/brands`;
                            window.open(brandsUrl, '_blank', 'noopener,noreferrer');
                            // Keep chat open
                          }}
                        >
                          {getButtonText('browseAll', userInfo?.language)}
                        </Button>
                      </Box>
                    )}
                  </Box>
                ))}
                
                {isLoading && (
                  <Box
                    sx={{
                      display: "flex",
                      justifyContent: "flex-start",
                      mb: 2,
                    }}
                  >
                    <Paper
                      sx={{
                        p: 2,
                        backgroundColor: "grey.100",
                        borderRadius: "20px 20px 20px 4px",
                      }}
                    >
                      <Box sx={{ display: "flex", alignItems: "center", gap: 1 }}>
                        <CircularProgress size={16} />
                        <Typography variant="body2">
                          Finding perfect matches...
                        </Typography>
                      </Box>
                    </Paper>
                  </Box>
                )}
                <div ref={chatEndRef} />
              </Box>

              {chatPhase === "recommendations" && (
                <Box sx={{ p: 2, borderTop: 1, borderColor: "divider", textAlign: "center" }}>
                  <Typography variant="caption" color="text.secondary" sx={{ mb: 2, display: "block" }}>
                    Need more help? Our franchise experts are here to assist you!
                  </Typography>
                  <Stack direction="row" spacing={1} justifyContent="center">
                    <Button 
                      variant="outlined" 
                      size="small"
                      onClick={() => {
                        const contactUrl = `${window.location.origin}/contact`;
                        window.open(contactUrl, '_blank', 'noopener,noreferrer');
                        // Keep chat open
                      }}
                    >
                      Contact Expert
                    </Button>
                    <Button 
                      variant="contained" 
                      size="small"
                      onClick={() => {
                        const brandsUrl = `${window.location.origin}/brands`;
                        window.open(brandsUrl, '_blank', 'noopener,noreferrer');
                        // Keep chat open
                      }}
                    >
                      View All Brands
                    </Button>
                  </Stack>
                </Box>
              )}
            </>
          )}
        </DialogContent>
      </Dialog>
    </>
  );
};

export default Chatbot;